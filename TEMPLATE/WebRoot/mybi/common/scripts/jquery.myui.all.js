var i18n_lang="zh";var i18n_conf='[{"name":"i18n_ok","zh":"确认","en":"ok" },'+' {"name":"i18n_cancel","zh":"取消","en":"cancel"},'+' {"name":"i18n_info","zh":"提示","en":"Information"},'+' {"name":"i18n_query","zh":"查询","en":"query"},'+' {"name":"i18n_dateNotCorrect","zh":"日期格式不正确","en":"Date format is not correct"},'+' {"name":"i18n_dateBeyondRange","zh":"日期超出指定范围","en":"Date beyond the specified range"},'+' {"name":"i18n_isUploading","zh":"文件正在上传,请稍后","en":"File is uploading,please wait.."},'+' {"name":"i18n_selFileBeforeUpload","zh":"请先选择文件后再上传","en":"Please select a file before upload"},'+' {"name":"i18n_fileSizeWrong","zh":"文件大小超出指定范围","en":"File size is too large"},'+' {"name":"i18n_fileTypeWrong","zh":"文件格式不正确","en":"File format is not correct"},'+' {"name":"i18n_fileIsSaving","zh":"正在保存中..","en":"Saving.."},'+' {"name":"i18n_clickScanToSel","zh":"点击浏览选择文件","en":"Click Browse to select"}'+"]";jQuery.extend({createUploadIframe:function(t,e){var a="jUploadFrame"+t;var n='<iframe id="'+a+'" name="'+a+'" style="position:absolute; top:-9999px; left:-9999px"';if(window.ActiveXObject){if(typeof e=="boolean"){n+=' src="'+"javascript:false"+'"'}else if(typeof e=="string"){n+=' src="'+e+'"'}}n+=" />";jQuery(n).appendTo(document.body);return jQuery("#"+a).get(0)},createUploadForm:function(t,e,a){var n="jUploadForm"+t;var i="jUploadFile"+t;var r=jQuery('<form  action="" method="POST" name="'+n+'" id="'+n+'" enctype="multipart/form-data"></form>');if(a){for(var o in a){jQuery('<input type="hidden" name="'+o+'" value="'+a[o]+'" />').appendTo(r)}}var l=jQuery("#"+e);var s=jQuery(l).clone();jQuery(l).attr("id",i);jQuery(l).before(s);jQuery(l).appendTo(r);jQuery(r).css("position","absolute");jQuery(r).css("top","-1200px");jQuery(r).css("left","-1200px");jQuery(r).appendTo("body");return r},ajaxFileUpload:function(t){t=jQuery.extend({},jQuery.ajaxSettings,t);var e=(new Date).getTime();var a=jQuery.createUploadForm(e,t.fileElementId,typeof t.data=="undefined"?false:t.data);var n=jQuery.createUploadIframe(e,t.secureuri);var i="jUploadFrame"+e;var r="jUploadForm"+e;if(t.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")}var o=false;var l={};if(t.global)jQuery.event.trigger("ajaxSend",[l,t]);var s=function(e){var n=document.getElementById(i);try{if(n.contentWindow){l.responseText=n.contentWindow.document.body?n.contentWindow.document.body.innerHTML:null;l.responseXML=n.contentWindow.document.XMLDocument?n.contentWindow.document.XMLDocument:n.contentWindow.document}else if(n.contentDocument){l.responseText=n.contentDocument.document.body?n.contentDocument.document.body.innerHTML:null;l.responseXML=n.contentDocument.document.XMLDocument?n.contentDocument.document.XMLDocument:n.contentDocument.document}}catch(r){jQuery.handleError(t,l,null,r)}if(l||e=="timeout"){o=true;var s;try{s=e!="timeout"?"success":"error";if(s!="error"){var d=jQuery.uploadHttpData(l,t.dataType);if(t.success)t.success(d,s);if(t.global)jQuery.event.trigger("ajaxSuccess",[l,t])}else jQuery.handleError(t,l,s)}catch(r){s="error";jQuery.handleError(t,l,s,r)}if(t.global)jQuery.event.trigger("ajaxComplete",[l,t]);if(t.global&&!--jQuery.active)jQuery.event.trigger("ajaxStop");jQuery(n).unbind();setTimeout(function(){try{jQuery(n).remove();jQuery(a).remove()}catch(e){jQuery.handleError(t,l,null,e)}},100);l=null}};if(t.timeout>0){setTimeout(function(){if(!o)s("timeout")},t.timeout)}try{var a=jQuery("#"+r);jQuery(a).attr("action",t.url);jQuery(a).attr("method","POST");jQuery(a).attr("target",i);if(a.encoding){jQuery(a).attr("encoding","multipart/form-data")}else{jQuery(a).attr("enctype","multipart/form-data")}jQuery(a).submit()}catch(d){jQuery.handleError(t,l,null,d)}jQuery("#"+i).load(s);return{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script")jQuery.globalEval(data);if(type=="json")eval('data = " '+data+' " ');if(type=="html")jQuery("<div>").html(data).evalScripts();return $.parseJSON($(data).text())},handleError:function(t,e,a,n){if(t.error){t.error.call(t.context||t,e,a,n)}if(t.global){(t.context?jQuery(t.context):jQuery.event).trigger("ajaxError",[e,t,n])}}});(function(t){t.fn.fileupload=function(a,n){if(typeof a=="string"){return t.fn.fileupload.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"fileupload");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.fileupload.defaults,t.fn.fileupload.parseOptions(this),a);r=t.data(this,"fileupload",{options:i});e(this)}})};function e(e){var l=t.data(e,"fileupload").options;var s=t(e).width();t(e).attr("readonly","readonly").val(myjs_getI18n("i18n_clickScanToSel")).removeClass().addClass("myui-fileupload-text").css("width",s-43);t(e).attr("runsta","free");t(e).after('<a id="'+t(e).attr("id")+'_uploadBtn" href="javascript:void(0)" class="myui-fileupload-btn">上传</a>');t(e).after('<span class="myui-fileupload-wrap" style="position:relative;display:inline-block"><a id="'+t(e).attr("id")+'_btn" href="javascript:void(0)" class="myui-fileupload-btn" style="position:absolute;z-index:0">浏览</a><input type="file" id="'+l.fileElementId+'" name="'+l.fileElementId+'" style="width:43px;height:22px;cursor: pointer;vertical-align:middle;position:absolute;;opacity: 0;filter: alpha(opacity=0);"/></span>');t("#"+l.fileElementId).bind("change",function(a){var n=t(this).val();t(e).val(n)});t("#"+t(e).attr("id")+"_uploadBtn").bind("click",function(s){var d=t(e).attr("runsta");if(d=="busy"){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_isUploading"),"info");return}var u=document.getElementById(l.fileElementId);if(u.value==""){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_selFileBeforeUpload"),"info");return}if(!n(e)){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_fileSizeWrong"),"info");return}if(!a(e)){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_fileTypeWrong"),"info");return}if(!l.beforeUpload.call(e,i(e),o(e),r(e))){return}var c,p=null;t(e).attr("runsta","busy");if(l.showProgress){var f=l.url.substring(0,l.url.indexOf("!")+1)+"readUploadStatus.action";p=setInterval(function(){t.getJSON(f,function(a){if(a.result=="SUCC"){if(a.status.bytesRead==a.status.contentLength!=0){t(e).val(myjs_getI18n("i18n_fileIsSaving"))}else{t(e).val((a.status.bytesRead/a.status.contentLength*100).toFixed(1)+"%")}}})},500)}t.ajaxFileUpload({url:l.url,secureuri:l.secureuri,fileElementId:l.fileElementId,dataType:l.dataType,data:l.data,timeout:l.timeout,success:function(a,n){t(e).attr("runsta","free");if(l.showProgress){clearInterval(p)}t(e).val(myjs_getI18n("i18n_clickScanToSel"));t("#"+l.fileElementId).bind("change",function(a){var n=t(this).val();t(e).val(n)});l.onUploadSuccess.call(e,a,n)},error:function(a,n,i){t(e).attr("runsta","free");if(l.showProgress){clearInterval(p)}t(e).val(myjs_getI18n("i18n_clickScanToSel"));t("#"+l.fileElementId).bind("change",function(a){var n=t(this).val();t(e).val(n)});l.onUploadError.call(e,a,n,i)}})})}function a(e){var a=t.data(e,"fileupload").options;if(a.fileType==null||a.fileType.length==0){return true}var n=document.getElementById(a.fileElementId).value;var i=n.substring(n.lastIndexOf(".")+1,n.length).toUpperCase();var r=false;for(var o=0;o<a.fileType.length;o++){if(a.fileType[o].toUpperCase()==i){r=true;break}}return r}function n(e){var a=t.data(e,"fileupload").options;var n=o(e);if(n==-1){return true}else if(n>a.fileSize){return false}else{return true}}function i(e){var a=t.data(e,"fileupload").options;return document.getElementById(a.fileElementId).value}function r(e){var a=t.data(e,"fileupload").options;var n=document.getElementById(a.fileElementId).value;return n.substring(n.lastIndexOf(".")+1,n.length).toUpperCase()}function o(e){var a=t.data(e,"fileupload").options;var n=t.browser;var i=-1;var r=document.getElementById(a.fileElementId);if(n.msie){}else{i=r.files[0].size}return i}t.fn.fileupload.defaults={url:"",data:null,fileElementId:"",secureuri:false,dataType:"text",fileSize:1024*1024*1024,fileType:null,timeout:null,showProgress:false,beforeUpload:function(t,e,a){},onUploadSuccess:function(t,e){},onUploadError:function(t,e,a){}};t.fn.fileupload.methods={options:function(e){return t.data(e[0],"fileupload").options}};t.fn.fileupload.parseOptions=function(e){var a=t(e);return t.extend({},t.parser.parseOptions(e,["fileElementId","url","dataType","fileSize","fileType","showProgress","showType","complateShow","beforeSend","success"]))}})(jQuery);(function(t){t.fn.combo=function(a,n){if(typeof a=="string"){return t.fn.combo.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"combo");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.combo.defaults,t.fn.combo.parseOptions(this),a);r=t.data(this,"combo",{options:i});e(this)}})};function e(e){t(e).attr("myui-type","combo");var n=t.data(e,"combo").options;var i=t(e).width();if(n.editable){t(e).css("width",i-21).css("border","none")}else{t(e).attr("readonly","readonly").css("width",i-21).css("border","none")}t(e).wrap('<span class="myui-combo-outer" style="width:'+i+'px;"></span>');t(e).after('<a class="myui-combo-arrow"></a>');var r=t(e).attr("id");t(e).parent().after('<div id="comboPanel_'+r+'" class="myui-combo-panel-normal" style="width:'+(n.panelWidth==null?i:n.panelWidth)+"px;height:"+n.panelHeight+'px"></div>');var o=false;n.iCount=null;var l="#comboPanel_"+t(e).attr("id");if(!n.disabled){t(e).parent().bind("click",function(a){if(t(l).css("display")!="none"){t(l).hide();clearInterval(n.iCount)}else{t.each(t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel"),function(e){if(t(this).css("display")!="none"){o=true}});if(o){t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel").hide();clearInterval(n.iCount)}t(l).slideDown("300");n.iCount=setInterval(function(){if(t(l)==undefined||t(l)==null){clearInterval(n.iCount)}if(t(l).prev().position().top+t(e).height()+2+n.panelHeight+t(n.scrollTarget).scrollTop()>t(n.scrollTarget).height()+t(n.scrollTarget).scrollTop()+40){t(l).css("top",t(l).prev().position().top-n.panelHeight)}else{t(l).css("top",t(l).prev().position().top+t(e).height()+2)}t(l).css("left",t(l).prev().position().left)},100)}a.stopPropagation()});t("body").bind("click",function(e){if(t(l).css("display")!="none"){t(l).hide();clearInterval(n.iCount)}})}else{t(e).attr("disabled","disabled")}a(e)}function a(e,a){var r=t.data(e,"combo").options;r.onBeforeLoad.call(e);var s=r.comboType.toUpperCase();t(e).val("");if(a!=undefined){r.data=a;n(e,r);i(e,r.data);if(r.data!=""&&r.data.length>0){if(s=="NORMAL-SINGLE"){if(r.defaultValue!=null){o(e,r.defaultValue)}else{o(e,r.data[0][r.valueField])}}else if(s=="NORMAL-MULTI"){if(r.defaultValue!=null){l(e,r.defaultValue)}else{l(e,r.data[0][r.valueField])}}}r.onLoadSuccess.call(e,r.data);if(r.searchable){var d=r.valueField;var u=r.textField;t(e).bind("keyup",function(a){var n=t(e).val();var o=[];if(n!=""){t.each(r.data,function(t,e){if(e[r.textField].indexOf(n)!=-1){o.push(e)}});i(e,o)}else{i(e,r.data)}})}}else if(r.mode=="local"){n(e,r);i(e,r.data);if(r.data!=""&&r.data.length>0){if(s=="NORMAL-SINGLE"){if(r.defaultValue!=null){o(e,r.defaultValue)}else{o(e,r.data[0][r.valueField])}}else if(s=="NORMAL-MULTI"){if(r.defaultValue!=null){l(e,r.defaultValue)}else{l(e,r.data[0][r.valueField])}}}r.onLoadSuccess.call(e,r.data);if(r.searchable){var d=r.valueField;var u=r.textField;t(e).bind("keyup",function(a){var n=t(e).val();var o=[];if(n!=""){t.each(r.data,function(t,e){if(e[r.textField].indexOf(n)!=-1){o.push(e)}});i(e,o)}else{i(e,r.data)}})}}else if(r.mode=="remote"){t.ajax({type:r.method,url:r.url,data:r.param,dataType:"json",success:function(a){r.data=a;n(e,r);i(e,r.data);if(r.data!=""&&r.data.length>0){if(s=="NORMAL-SINGLE"){if(r.defaultValue!=null){o(e,r.defaultValue)}else{o(e,r.data[0][r.valueField])}}else if(s=="NORMAL-MULTI"){if(r.defaultValue!=null){l(e,r.defaultValue)}else{l(e,r.data[0][r.valueField])}}}r.onLoadSuccess.call(e,r.data);if(r.searchable){var d=r.valueField;var u=r.textField;t(e).bind("keyup",function(a){var n=t(e).val();var o=[];if(n!=""){t.each(r.data,function(t,e){if(e[r.textField].indexOf(n)!=-1){o.push(e)}});i(e,o)}else{i(e,r.data)}})}},error:function(){r.onLoadError.call(e,r.data)}})}}function n(e,a){if(a.isCustom){if(a.customData!=null){if(!isNaN(a.customPosition)){var n=a.data;if(a.customPosition>a.data.length){return}else{var i=a.customPosition;t.each(a.customData,function(t){n.splice(i,0,a.customData[t]);i++});a.data=n}}else if(a.customPosition=="top"){var r=a.customData;a.data=r.concat(a.data)}else if(a.customPosition=="bottom"){var n=a.data;a.data=n.concat(a.customData)}}}}function i(e,a){var n=t("#comboPanel_"+t(e).attr("id"));var i=t.data(e,"combo").options;var s=i.comboType.toUpperCase();var d=i.valueField;var u=i.textField;r(e);t(n).append("<div></div>");if(s=="NORMAL-MULTI"){for(var p=0;p<a.length;p++){t(n).find("div").append("<p val='"+a[p][d]+"'><input id='cbx_"+a[p][d]+"' type='checkbox' style='vertical-align:middle;margin-right:3px;width:15px;border:none;background-color:#FFF;height:15px;'/>"+a[p][u]+"</p>")}}else if(s=="NORMAL-SINGLE"){for(var p=0;p<a.length;p++){t(n).find("div").append("<p val='"+a[p][d]+"'>"+a[p][u]+"</p>")}}if(i.readonly||i.disabled){return}t(n).find("p,p input").bind("click",function(a){if(s=="NORMAL-SINGLE"){t(n).find("p").removeClass("selected");t(this).addClass("selected");t(n).hide();clearInterval(i.iCount);o(e,t(this).attr("val"));i.onSelect.call(e,c(e,t(this).attr("val")))}else if(s=="NORMAL-MULTI"){a.stopPropagation();var r=[];if(t(this).find("input").is(":checked")){t(this).find("input").removeAttr("checked");t.each(t(n).find("p input:checked"),function(e){r.push(t(this).parent().attr("val"))});l(e,r);i.onUnselect.call(e,c(e,t(this).attr("val")))}else{t(this).find("input").attr("checked","checked");t.each(t(n).find("p input:checked"),function(e){r.push(t(this).parent().attr("val"))});l(e,r);i.onSelect.call(e,c(e,t(this).attr("val")))}}a.stopPropagation()})}function r(e){var a=t("#comboPanel_"+t(e).attr("id"));var n=t.data(e,"combo").options;t(a).empty();n.currentValue=null;n.currentText=null}function o(e,a){var n=t(e).combo("options");var i=t("#comboPanel_"+t(e).attr("id"));t(i).find("p").removeClass("selected");t(i).find("p[val='"+a+"']").addClass("selected");t.each(t(i).find("p[val='"+a+"']"),function(i){n.currentValue=a;n.currentText=t(this).text();t(e).attr("value",t(this).text());t(e).focus()})}function l(e,a){var n=t(e).combo("options");var i=t("#comboPanel_"+t(e).attr("id"));var r=[],o=[];t(i).find("p input").removeAttr("checked");for(var l=0;l<a.length;l++){t(i).find("p[val='"+a[l]+"'] input").attr("checked","checked")}t.each(t(i).find("p input:checked"),function(e){r.push(t(this).parent().attr("val"));o.push(t(this).parent().text())});n.currentValue=r;n.currentText=o;var s="";for(var l=0;l<o.length;l++){if(l==o.length-1){s+=o[l]}else{s+=o[l]+","}}t(e).attr("value",s);t(e).focus()}function s(e){var a=t(e).combo("options");return a.currentValue}function d(e){var a=t(e).combo("options");var n=t("#comboPanel_"+t(e).attr("id"));t(e).val("");t(n).find("p").removeClass("selected");a.currentValue=null;a.currentText=null}function u(e){var a=t(e).combo("options");if(a.iCount!=null){clearInterval(a.iCount)}}function c(e,a){var n=t(e).combo("options");var i=n.data;var r=n.valueField;for(var o=0;o<i.length;o++){if(i[o][r]==a){return i[o]}}}function p(e){var a=t.data(e,"combo");var n=a.options;return n.currentText}t.fn.combo.defaults={comboType:"normal-single",mode:"remote",url:"",param:null,data:null,method:"post",valueField:"value",textField:"text",defaultValue:null,isCustom:false,customData:null,customPosition:"top",panelHeight:200,panelWidth:null,disabled:false,readonly:false,editable:false,searchable:false,scrollTarget:"body",onBeforeLoad:function(){},onLoadSuccess:function(){},onLoadError:function(){},onSelect:function(t){},onUnselect:function(t){}};t.fn.combo.methods={options:function(e){return t.data(e[0],"combo").options},getData:function(e){var a=t(e).combo("options");return a.data},getValue:function(t){return s(t[0])},getValues:function(t){return s(t[0])},getText:function(t){return p(t[0])},getTexts:function(t){return p(t[0])},setValue:function(t,e){return t.each(function(){o(this,e)})},setValues:function(t,e){return t.each(function(){l(this,e)})},loadData:function(t,e){return t.each(function(){a(this,e)})},reset:function(t){return t.each(function(){d(this)})},destroy:function(t){return t.each(function(){u(this)})}};t.fn.combo.parseOptions=function(e){var a=t(e);return t.extend({},t.parser.parseOptions(e,["url","mode","textField","valueField","comboType","method","panelHeight","panelWidth"]))}})(jQuery);(function(t){t.fn.comboSD=function(a,n){if(typeof a=="string"){return t.fn.comboSD.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"comboSD");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.comboSD.defaults,t.fn.comboSD.parseOptions(this),a);r=t.data(this,"comboSD",{options:i});e(this)}})};function e(e){t(e).attr("myui-type","comboSD");var a=t.data(e,"comboSD").options;var i=t(e).width();if(a.editable){t(e).css("width",i-21).css("border","none")}else{t(e).attr("readonly","readonly").css("width",i-21).css("border","none")}t(e).wrap('<span class="myui-combo-outer" style="width:'+i+'px;"></span>');t(e).after('<a class="myui-combo-arrow"></a>');var r=t(e).attr("id");t(e).parent().after('<div id="comboSDPanel_'+r+'" class="myui-comboSD-panel" style="width:'+(a.panelWidth==null?i:a.panelWidth)+"px;height:"+a.panelHeight+'px"></div>');var o=false;a.iCount=null;var l="#comboSDPanel_"+t(e).attr("id");if(!a.disabled){t(e).parent().bind("click",function(n){if(t(l).css("display")!="none"){if(a.autoHide){t(l).hide();clearInterval(a.iCount)}}else{t.each(t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel"),function(e){if(t(this).css("display")!="none"){o=true}});if(o){t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel").hide();clearInterval(a.iCount)}t(l).slideDown("300");a.iCount=setInterval(function(){if(t(l).prev().position().top+t(e).height()+2+a.panelHeight+t(a.scrollTarget).scrollTop()>t(a.scrollTarget).height()+t(a.scrollTarget).scrollTop()+40){t(l).css("top",t(l).prev().position().top-a.panelHeight)}else{t(l).css("top",t(l).prev().position().top+t(e).height()+2)}t(l).css("left",t(l).prev().position().left)},100)}n.stopPropagation()});t("body").bind("click",function(e){if(t(l).css("display")!="none"){if(a.autoHide){t(l).hide();clearInterval(a.iCount)}}})}else{t(e).attr("disabled","disabled")}var s="<div id='comboSD_InnerDiv_"+r+"' class='myui-comboSD-panel-div' ";if(a.showBtnZone){s+="style='height:"+(a.panelHeight-33)+"px;'";s+="></div><div class='myui-comboSD-btnZone'><table style='width:100%' cellpadding='0' cellspacing='0'>";s+="<tr style='height:30px'><td align='left' style='padding:5px 0'>";if(a.buttons!=null){for(var d=0;d<a.buttons.length;d++){if(a.buttons[d].position.toUpperCase()=="LEFT"){s+="<a class='myui-comboSD-btn' id='"+a.buttons[d].id+"' href='javascript:void(0)'>"+a.buttons[d].name+"</a>"}}}s+="</td><td align='right' style='padding:5px 0'>";if(a.buttons!=null){for(var d=0;d<a.buttons.length;d++){if(a.buttons[d].position.toUpperCase()=="RIGHT"){s+="<a class='myui-comboSD-btn' id='"+a.buttons[d].id+"' href='javascript:void(0)'>"+a.buttons[d].name+"</a>"}}}s+="</td></tr>";s+="</table></div>"}else{s+="></div>"}t(l).append(s);t(l).children().bind("click",function(t){a.onClickPanel.call(e,n(e));if(a.stopPropagation){t.stopPropagation()}});if(a.buttons!=null){t.each(a.buttons,function(a,i){t("#"+i.id).bind("click",function(t){i.onClickBtn.call(e,n(e))})})}a.initPanelContent.call(e,n(e))}function a(e){var a=t.data(e,"comboSD");var n=a.options;var i=t("#comboSD_InnerDiv_"+t(e).attr("id"));t(i).html("");n.initPanelContent.call(e,i)}function n(e){return t("#comboSD_InnerDiv_"+t(e).attr("id"))}function i(e){var a=t.data(e,"comboSD");var n=a.options;var i="comboSDPanel_"+t(e).attr("id");t("#"+i).hide();if(n.iCount!=null&&n.iCount!=undefined){clearInterval(n.iCount)}}function r(e,a){t(e).val(a)}t.fn.comboSD.defaults={showBtnZone:false,buttons:null,stopPropagation:true,panelHeight:200,panelWidth:null,disabled:false,editable:false,autoHide:true,scrollTarget:"body",initPanelContent:function(t){},onClickPanel:function(t){}};t.fn.comboSD.methods={options:function(e){return t.data(e[0],"comboSD").options},getInnerPanel:function(t){return n(t[0])},closePanel:function(t){return t.each(function(){i(this)})},setText:function(t,e){return t.each(function(){r(this,e)})},reload:function(t){return t.each(function(){a(this)})}};t.fn.comboSD.parseOptions=function(e){var a=t(e);return t.extend({},t.parser.parseOptions(e,["showBtnZone","buttons","disabled","editable","initPanelContent","panelHeight","panelWidth"]))}})(jQuery);(function(t){t.fn.datebox=function(e,a){if(typeof e=="string"){return t.fn.datebox.methods[e](this,a)}e=e||{};return this.each(function(){var a=t(this).attr("id");var n;var r=t.data(this,"datebox");if(r){n=t.extend(r.options,e);i(this)}else{n=t.extend({},t.fn.datebox.defaults,t.fn.datebox.parseOptions(this),e);r=t.data(this,"datebox",{options:n});i(this)}})};var e=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"];var a=["第1季度(1月~3月)","第2季度(4月~6月)","第3季度(7月~9月)","第4季度(10月~12月)"];var n=["上旬","中旬","下旬"];function i(e){t(e).attr("myui-type","datebox");var a=t.data(e,"datebox").options;var n=t(e).width();if(a.editable&&a.showIcon){t(e).css("width",n-22).css("border","none");t(e).wrap('<span class="myui-combo-outer" style="width:'+n+'px;"></span>');t(e).after('<a class="myui-combo-datebox_arrow"></a>')}else if(!a.editable&&a.showIcon){t(e).attr("readonly","readonly").css("width",n-22).css("border","none");t(e).wrap('<span class="myui-combo-outer" style="width:'+n+'px;"></span>');t(e).after('<a class="myui-combo-datebox_arrow"></a>')}else if(a.editable&&!a.showIcon){t(e).css("border","none");t(e).wrap('<span class="myui-combo-outer" style="width:'+n+'px;"></span>')}else{t(e).attr("readonly","readonly").css("border","none");t(e).wrap('<span class="myui-combo-outer" style="width:'+n+'px;"></span>')}var i=t(e).attr("id");t(e).parent().after('<div id="dateboxPanel_'+i+'" class="myui-datebox-panel"></div>');var o="#dateboxPanel_"+t(e).attr("id");var l=a.calendarType.toUpperCase();t(o).bind("click",function(t){t.stopPropagation()});var u="",p;if(l=="DATE"){if(a.defaultDate!=""){t(e).val(a.defaultDate);p=b(a.defaultDate,a.dateFormat);a.ynow=p.year;a.mnow=p.month;a.dnow=p.day}r(e,a);if(a.autoValidate){t("body").bind("click",function(n){n.stopPropagation();if(!d(t(e).val(),a.dateFormat,l)){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_dateNotCorrect"),"info");t(e).val(c(a.ynow+a.mnow+a.dnow,a.dateFormat));return}else if(!s(t(e).val(),a.dateFormat,a.range)){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_dateBeyondRange"),"info");t(e).val(c(a.ynow+a.mnow+a.dnow,a.dateFormat));return}else{if(t(e).val()==""){return}p=b(t(e).val(),a.dateFormat);a.ynow=p.year;a.mnow=p.month;a.dnow=p.day}})}}else if(l=="MONTH"){if(a.defaultDate!=""){t(e).val(a.defaultDate);p=$(a.defaultDate,a.dateFormat);a.ynow=p.year;a.mnow=p.month}r(e,a);if(a.autoValidate){t("body").bind("click",function(n){n.stopPropagation();if(!d(t(e).val(),a.dateFormat,l)){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_dateNotCorrect"),"info");t(e).val(c(a.ynow+a.mnow+a.dnow,a.dateFormat));return}else{if(t(e).val()==""){return}p=$(t(e).val(),a.dateFormat);a.ynow=p.year;a.mnow=p.month}})}}else if(l=="QUARTER"){t(e).attr("readonly","readonly");if(a.defaultDate!=""){t(e).val(f(a.defaultDate));p=w(a.defaultDate);a.ynow=p.year;a.qnow=p.quarter}r(e,a)}else if(l=="EML"){t(e).attr("readonly","readonly");if(a.defaultDate!=""){t(e).val(m(a.defaultDate));p=x(a.defaultDate);a.ynow=p.year;a.mnow=p.month;a.pnow=p.period}r(e,a)}else if(l=="YEAR"){if(a.defaultDate!=""){t(e).val(a.defaultDate);a.ynow=a.defaultDate}r(e,a);if(a.autoValidate){t("body").bind("click",function(n){n.stopPropagation();if(!d(t(e).val(),a.dateFormat,l)){t.messager.alert(myjs_getI18n("i18n_info"),myjs_getI18n("i18n_dateNotCorrect"),"info");t(e).val(a.ynow);return}else{if(t(e).val()==""){return}a.ynow=t(e).val()}})}}else if(l=="HALFYEAR"){t(e).attr("readonly","readonly");if(a.defaultDate!=""){t(e).val(h(a.defaultDate));p=C(a.defaultDate);a.ynow=p.year;a.hnow=p.half}r(e,a)}var v=false;a.iCount=null;if(!a.disabled){t(e).parent().bind("click",function(n){if(t(o).css("display")!="none"){t(o).hide();clearInterval(a.iCount)}else{t.each(t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel"),function(e){if(t(this).css("display")!="none"){v=true}});if(v){t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel").hide();clearInterval(a.iCount)}t(o).slideDown("100");r(e,a);a.iCount=setInterval(function(){if(t(o).prev().position().top+t(e).height()+2+t(o).height()+t(a.scrollTarget).scrollTop()>t(a.scrollTarget).height()+t(a.scrollTarget).scrollTop()+40){t(o).css("top",t(o).prev().position().top-t(o).height()-4)}else{t(o).css("top",t(o).prev().position().top+t(e).height()+2)}t(o).css("left",t(o).prev().position().left)},100)}n.stopPropagation()});t("body").bind("click",function(e){if(t(o).css("display")!="none"){t(o).hide();clearInterval(a.iCount)}})}else{t(e).attr("disabled","disabled")}}function r(i,d){var b="#dateboxPanel_"+t(i).attr("id");var $="";var k=d.calendarType.toUpperCase();var T=new Date;if(k=="DATE"){var S=parseInt(d.ynow==null||d.ynow==undefined?T.getFullYear():d.ynow,10);var I=parseInt(d.mnow==null||d.mnow==undefined?T.getMonth()+1:d.mnow,10);var D=parseInt(d.dnow==null||d.dnow==undefined?T.getDate():d.dnow,10);d.ynow=_(S.toString(),4);d.mnow=_(I.toString(),2);d.dnow=_(D.toString(),2);$+="<table style='width:100%;' border='0' cellspacing='0' cellpadding='0'><tr height='18'>";$+="<td class='year_L'></td><td class='month_L'></td>";$+="<td align='center' style='background-color:#F0F0F0;font-size:13px;'>"+S+"年"+I+"月</td>";$+="<td class='month_R'></td><td class='year_R'></td>";$+="</tr></table>";t(b).html($);t(b+" .year_L,.year_R,.month_L,.month_R").bind("click",function(e){k=t(this).attr("class");var a,n,o,l;a=parseInt(d.ynow,10);l=n=parseInt(d.mnow,10);o=0;if(k=="year_L"){a--}else if(k=="year_R"){a++}else if(k=="month_L"){n=n-1<=0?12:n-1;a=l-1<=0?a-1:a}else{n=n+1>12?1:n+1;a=l+1>12?a+1:a}d.ynow=_(a,4);d.mnow=_(n,2);d.dnow=_(o,2);r(i,d);e.stopPropagation()});var O=new Date(S,I-1,1);var P=O.getDay();var F=new Array(31,28+u(S),31,30,31,30,31,31,30,31,30,31);var E=Math.ceil((F[I-1]+P)/7);$="<table class='myui-datebox-date_table' border='0' cellpadding='0' cellspacing='0'><tr class='week-title'><td class='weekend'>日</td><td class='workday'>一</td><td class='workday'>二</td><td class='workday'>三</td><td class='workday'>四</td><td class='workday'>五</td><td class='weekend'>六</td></tr>";var L=new Date;var z,q,H,M=0;var A=0,V=0,U;if(d.range!=null){A=l(d.dateFormat,d.range).min;V=l(d.dateFormat,d.range).max}for(R=0;R<(E<6?E+1:E);R++){$+="<tr class='days'>";for(N=0;N<7;N++){idx=R*7+N;date_str=idx-P+1;if(date_str<=0){q=I-1<=0?12:I-1;z=I-1<=0?S-1:S;H=F[q-1]+date_str;U=parseInt(_(z.toString(),4)+_(q.toString(),2)+_(H.toString(),2),10);if(o(U,A,V)){$+="<td class='selectable notCurMon' year='"+z+"' month='"+q+"'>"+H+"</td>"}else{$+="<td class='unselectable notCurMon' year='"+z+"' month='"+q+"'>"+H+"</td>"}}else if(date_str>F[I-1]){q=I+1>12?1:I+1;z=I+1>12?S+1:S;H=++M;U=parseInt(_(z.toString(),4)+_(q.toString(),2)+_(H.toString(),2),10);if(o(U,A,V)){$+="<td class='selectable notCurMon' year='"+z+"' month='"+q+"'>"+H+"</td>"}else{$+="<td class='unselectable notCurMon' year='"+z+"' month='"+q+"'>"+H+"</td>"}}else{U=parseInt(_(S.toString(),4)+_(I.toString(),2)+_(date_str.toString(),2),10);if(o(U,A,V)){if(S==L.getFullYear()&&I==L.getMonth()+1&&L.getDate()==date_str){$+="<td class='selectable today' year='"+S+"' month='"+I+"'>"+date_str+"</td>"}else if(date_str==D){$+="<td class='selectable selected' year='"+S+"' month='"+I+"'>"+date_str+"</td>"}else{$+="<td class='selectable' year='"+S+"' month='"+I+"'>"+date_str+"</td>"}}else{$+="<td class='unselectable' year='"+S+"' month='"+I+"'>"+date_str+"</td>"}}}$+="</tr>"}$+="</table>";t(b).append($);t(b+" .myui-datebox-date_table .days .selectable").bind("click",function(e){e.stopPropagation();d.ynow=_(t(this).attr("year"),4);d.mnow=_(t(this).attr("month"),2);d.dnow=_(t(this).text(),2);t(i).val(c(d.ynow+d.mnow+d.dnow,d.dateFormat));t(b).hide();t(i).focus();d.onSelect.call(i,c(d.ynow+d.mnow+d.dnow,d.dateFormat))})}else if(k=="MONTH"){var S=parseInt(d.ynow==null||d.ynow==undefined?T.getFullYear():d.ynow,10);var I=parseInt(d.mnow==null||d.mnow==undefined?T.getMonth()+1:d.mnow,10);d.ynow=_(S.toString(),4);d.mnow=_(I.toString(),2);$+="<table style='width:100%;' border='0' cellspacing='0' cellpadding='0'><tr height='18'>";$+="<td class='year_L'></td>";$+="<td align='center' style='background-color:#F0F0F0;font-size:13px;'>"+S+"年</td>";$+="<td class='year_R'></td>";$+="</tr></table>";t(b).html($);t(b+" .year_L,.year_R").bind("click",function(e){k=t(this).attr("class");var a,n;a=parseInt(d.ynow,10);n=0;if(k=="year_L"){a--}else if(k=="year_R"){a++}d.ynow=_(a,4);d.mnow=_(n,2);r(i,d);e.stopPropagation()});$="<table class='myui-datebox-date_table' border='0' cellpadding='0' cellspacing='0'>";for(var R=0;R<3;R++){$+="<tr class='months'>";for(var N=0;N<4;N++){mon=R*4+N+1;if(S==T.getFullYear()&&mon==T.getMonth()+1){$+="<td class='selectable today' year='"+S+"' month='"+mon+"'>"+e[mon-1]+"</td>"}else if(mon==I){$+="<td class='selectable selected' year='"+S+"' month='"+mon+"'>"+e[mon-1]+"</td>"}else{$+="<td class='selectable' year='"+S+"' month='"+mon+"'>"+e[mon-1]+"</td>"}}$+="</tr>"}$+="</table>";t(b).append($);t(b+" .myui-datebox-date_table .months .selectable").bind("click",function(e){e.stopPropagation();d.ynow=_(t(this).attr("year"),4);d.mnow=_(t(this).attr("month"),2);t(i).val(p(d.ynow+d.mnow,d.dateFormat));t(b).hide();t(i).focus();d.onSelect.call(i,p(d.ynow+d.mnow,d.dateFormat))})}else if(k=="QUARTER"){var S=parseInt(d.ynow==null||d.ynow==undefined?T.getFullYear():d.ynow,10);var B=parseInt(d.qnow==null||d.qnow==undefined?v(T.getMonth()+1):d.qnow,10);d.ynow=_(S.toString(),4);d.qnow=B.toString();$+="<table style='width:100%;' border='0' cellspacing='0' cellpadding='0'><tr height='18'>";$+="<td class='year_L'></td>";$+="<td align='center' style='background-color:#F0F0F0;font-size:13px;'>"+S+"年</td>";$+="<td class='year_R'></td>";$+="</tr></table>";t(b).html($);t(b+" .year_L,.year_R").bind("click",function(e){t(i).val("");k=t(this).attr("class");var a,n;a=parseInt(d.ynow,10);n=0;if(k=="year_L"){a--}else if(k=="year_R"){a++}d.ynow=_(a,4);d.qnow=n+"";r(i,d);e.stopPropagation()});$="<table class='myui-datebox-date_table' border='0' cellpadding='0' cellspacing='0'>";for(var R=0;R<4;R++){$+="<tr class='quarters'>";qua=R+1;if(S==T.getFullYear()&&qua==v(T.getMonth()+1)){$+="<td class='selectable today' year='"+S+"' quarter='"+qua+"'>"+a[qua-1]+"</td>"}else if(qua==B){$+="<td class='selectable selected' year='"+S+"' quarter='"+qua+"'>"+a[qua-1]+"</td>"}else{$+="<td class='selectable' year='"+S+"' quarter='"+qua+"'>"+a[qua-1]+"</td>"}$+="</tr>"}$+="</table>";t(b).append($);t(b+" .myui-datebox-date_table .quarters .selectable").bind("click",function(e){e.stopPropagation();d.ynow=_(t(this).attr("year"),4);d.qnow=t(this).attr("quarter");t(i).val(f(d.ynow+"Q"+d.qnow));t(i).focus();t(b).hide();d.onSelect.call(i,d.ynow+"Q"+d.qnow)})}else if(k=="EML"){var S=parseInt(d.ynow==null||d.ynow==undefined?T.getFullYear():d.ynow,10);var I=parseInt(d.mnow==null||d.mnow==undefined?T.getMonth()+1:d.mnow,10);var W=d.pnow==null||d.pnow==undefined?g(T.getDate()):d.pnow;d.ynow=_(S.toString(),4);d.mnow=_(I.toString(),2);d.pnow=W.toString();$+="<table style='width:100%;' border='0' cellspacing='0' cellpadding='0'><tr height='18'>";
$+="<td class='year_L'></td><td class='month_L'></td>";$+="<td align='center' style='background-color:#F0F0F0;font-size:13px;'>"+S+"年"+I+"月</td>";$+="<td class='month_R'></td><td class='year_R'></td>";$+="</tr></table>";t(b).html($);t(b+" .year_L,.year_R,.month_L,.month_R").bind("click",function(e){t(i).val("");k=t(this).attr("class");var a,n,o,l;a=parseInt(d.ynow,10);l=n=parseInt(d.mnow,10);o="0";if(k=="year_L"){a--}else if(k=="year_R"){a++}else if(k=="month_L"){n=n-1<=0?12:n-1;a=l-1<=0?a-1:a}else{n=n+1>12?1:n+1;a=l+1>12?a+1:a}d.ynow=_(a,4);d.mnow=_(n,2);d.pnow=o;r(i,d);e.stopPropagation()});$="<table class='myui-datebox-date_table' border='0' cellpadding='0' cellspacing='0'>";for(var R=0;R<3;R++){$+="<tr class='emls'>";eml=R==0?"E":R==1?"M":"L";if(S==T.getFullYear()&&I==T.getMonth()+1&&eml==g(T.getDate())){$+="<td class='selectable today' year='"+S+"' month='"+I+"' peroid='"+eml+"'>"+n[R]+"</td>"}else if(eml==W){$+="<td class='selectable selected' year='"+S+"' month='"+I+"' peroid='"+eml+"'>"+n[R]+"</td>"}else{$+="<td class='selectable' year='"+S+"' month='"+I+"' peroid='"+eml+"'>"+n[R]+"</td>"}$+="</tr>"}$+="</table>";t(b).append($);t(b+" .myui-datebox-date_table .emls .selectable").bind("click",function(e){e.stopPropagation();d.ynow=_(t(this).attr("year"),4);d.mnow=_(t(this).attr("month"),2);d.pnow=t(this).attr("peroid");t(i).val(m(d.ynow+d.mnow+d.pnow));t(b).hide();t(i).focus();d.onSelect.call(i,d.ynow+d.mnow+d.pnow)})}else if(k=="YEAR"){var S=parseInt(d.ynow==null||d.ynow==undefined?T.getFullYear():d.ynow,10);var Q=S-5;var Y=S+6;d.ynow=_(S.toString(),4);$+="<table style='width:100%;' border='0' cellspacing='0' cellpadding='0'><tr height='18'>";$+="<td class='year_L'></td>";$+="<td align='center' style='background-color:#F0F0F0;font-size:13px;'>"+Q+"~"+Y+"年</td>";$+="<td class='year_R'></td>";$+="</tr></table>";t(b).html($);t(b+" .year_L,.year_R").bind("click",function(e){k=t(this).attr("class");var a;a=parseInt(d.ynow,10);if(k=="year_L"){a-=12}else if(k=="year_R"){a+=12}d.ynow=_(a,4);r(i,d);e.stopPropagation()});$="<table class='myui-datebox-date_table' border='0' cellpadding='0' cellspacing='0'>";for(var R=0;R<3;R++){$+="<tr class='years'>";for(var N=0;N<4;N++){year=Q+(R*4+N);if(year==T.getFullYear()){$+="<td class='selectable today' year='"+year+"'>"+year+"</td>"}else if(year==S){$+="<td class='selectable selected' year='"+year+"'>"+year+"</td>"}else{$+="<td class='selectable' year='"+year+"'>"+year+"</td>"}}$+="</tr>"}$+="</table>";t(b).append($);t(b+" .myui-datebox-date_table .years .selectable").bind("click",function(e){e.stopPropagation();d.ynow=_(t(this).attr("year"),4);t(i).val(d.ynow);t(b).hide();t(i).focus();d.onSelect.call(i,d.ynow)})}else if(k=="HALFYEAR"){var S=parseInt(d.ynow==null||d.ynow==undefined?T.getFullYear():d.ynow,10);var J=parseInt(d.hnow==null||d.hnow==undefined?y(T.getMonth()+1):d.hnow,10);var Q=S-2;var Y=S+3;d.ynow=_(S.toString(),4);d.hnow=J.toString();$+="<table style='width:100%;' border='0' cellspacing='0' cellpadding='0'><tr height='18'>";$+="<td class='year_L'></td>";$+="<td align='center' style='background-color:#F0F0F0;font-size:13px;'>"+Q+"~"+Y+"年</td>";$+="<td class='year_R'></td>";$+="</tr></table>";t(b).html($);t(b+" .year_L,.year_R").bind("click",function(e){k=t(this).attr("class");var a;a=parseInt(d.ynow,10);if(k=="year_L"){a-=6}else if(k=="year_R"){a+=6}d.ynow=_(a,4);r(i,d);e.stopPropagation()});$="<table class='myui-datebox-date_table' border='0' cellpadding='0' cellspacing='0'>";for(var R=0;R<3;R++){$+="<tr class='halfyears'>";for(var N=0;N<4;N++){half=N%2==0?1:2;year=Q+(R*2+(N<2?0:1));if(year==T.getFullYear()&&half==y(T.getMonth()+1)){$+="<td class='selectable today' year='"+year+"' half='"+half+"'>"+year+(half==1?"上":"下")+"</td>"}else if(year==S&&half==J){$+="<td class='selectable selected' year='"+year+"' half='"+half+"'>"+year+(half==1?"上":"下")+"</td>"}else{$+="<td class='selectable' year='"+year+"' half='"+half+"'>"+year+(half==1?"上":"下")+"</td>"}}$+="</tr>"}$+="</table>";t(b).append($);t(b+" .myui-datebox-date_table .halfyears .selectable").bind("click",function(e){e.stopPropagation();d.ynow=_(t(this).attr("year"),4);d.hnow=t(this).attr("half");t(i).val(h(d.ynow+"H"+d.hnow));t(b).hide();t(i).focus();d.onSelect.call(i,d.ynow+"H"+d.hnow)})}if(d.buttons){t(b).append("<div class='myui-datebox-btnZone'><a class='myui-datebox-btn' href='javascript:void(0);'>今天</a></div>");t(b+" .myui-datebox-btnZone a").eq(0).bind("click",function(e){e.stopPropagation();var a=parseInt(T.getFullYear(),10);var n=parseInt(T.getMonth()+1,10);var r=parseInt(T.getDate(),10);var o=_(a+"",4)+_(n+"",2)+_(r+"",2);if(k=="DATE"&&s(o,"YYYYMMDD",d.range)){d.ynow=_(a+"",4);d.mnow=_(n+"",2);d.dnow=_(r+"",2);t(i).val(c(d.ynow+d.mnow+d.dnow,d.dateFormat));t(b).hide();d.onSelect.call(i,c(d.ynow+d.mnow+d.dnow,d.dateFormat))}else if(k=="MONTH"){d.ynow=_(a+"",4);d.mnow=_(n+"",2);t(i).val(p(d.ynow+d.mnow,d.dateFormat));t(b).hide();d.onSelect.call(i,p(d.ynow+d.mnow,d.dateFormat))}else if(k=="YEAR"){d.ynow=_(a+"",4);t(i).val(d.ynow);t(b).hide();d.onSelect.call(i,d.ynow)}else if(k=="QUARTER"){var l=j(i,o);var u=w(l);d.ynow=u.year;d.qnow=u.quarter;t(i).val(f(d.ynow+"Q"+d.qnow));t(b).hide();d.onSelect.call(i,d.ynow+"Q"+d.qnow)}else if(k=="EML"){var l=j(i,o);var u=x(l);d.ynow=u.year;d.mnow=u.month;d.pnow=u.eml;t(i).val(m(d.ynow+d.mnow+d.pnow));t(b).hide();d.onSelect.call(i,d.ynow+d.mnow+d.pnow)}else if(k=="HALFYEAR"){var l=j(i,o);var u=C(l);d.ynow=u.year;d.hnow=u.half;t(i).val(h(d.ynow+"H"+d.hnow));t(b).hide();d.onSelect.call(i,d.ynow+"H"+d.hnow)}t(i).focus()})}}function o(t,e,a){if(e==0&&a==0){return true}else if(e!=0&&a==0&&t>=e){return true}else if(e==0&&a!=0&&t<=a){return true}else if(e!=0&&a!=0&&t>=e&&t<=a){return true}return false}function l(e,a){var n,i;try{n=a.min==undefined?0:a.min.type.toUpperCase()=="CONSTANT"?parseInt(b(a.min.value,e).date,10):parseInt(b(t(a.min.value).val(),t(a.min.value).datebox("options").dateFormat).date,10);i=a.max==undefined?0:a.max.type.toUpperCase()=="CONSTANT"?parseInt(b(a.max.value,e).date,10):parseInt(b(t(a.max.value).val(),t(a.max.value).datebox("options").dateFormat).date,10)}catch(r){n=0;i=0}return{min:n,max:i}}function s(t,e,a){if(t==""){return true}var n=b(t,e).date+"";var i=l(e,a);if(i.min==0&&i.max==0){return true}else if(i.min!=0&&i.max==0&&n>=i.min){return true}else if(i.min==0&&i.max!=0&&n<=i.max){return true}else if(i.min!=0&&i.max!=0&&n>=i.min&&n<=i.max){return true}return false}function d(t,e,a){if(t==""){return true}var n=/^(?:(?:(?:(?:(?:1[6-9]|[2-9][0-9])?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00)))()(?:0?2\1(?:29)))|(?:(?:(?:1[6-9]|[2-9][0-9])?[0-9]{2})()(?:(?:(?:0?[13578]|1[02])\2(?:31))|(?:(?:0?[13-9]|1[0-2])\2(?:29|30))|(?:(?:0?[1-9])|(?:1[0-2]))\2(?:0?[1-9]|1[0-9]|2[0-8]))))$/;var i=/^\b[1-3]\d{3}(0[1-9]|1[0-2])$/;var r=/^\b[1-3]\d{3}$/;var o,l;try{if(a=="DATE"){o=b(t,e).date+"";l=o.match(n)}else if(a=="MONTH"){o=$(t,e).date+"";l=o.match(i)}else if(a=="YEAR"){l=t.match(r)}if(l==null)return false}catch(s){return false}return true}function u(t){return t%100==0?res=t%400==0?1:0:res=t%4==0?1:0}function c(t,e){var a=t.substring(0,4);var n=t.substring(4,6);var i=t.substring(6,8);return e.replace(/YYYY/,a).replace(/MM/,n).replace(/DD/,i)}function p(t,e){var a=t.substring(0,4);var n=t.substring(4,6);return e.replace(/YYYY/,a).replace(/MM/,n)}function f(t){var e=t.split("Q");return e[0]+a[e[1]-1]}function m(t){var e=t.substring(0,4);var a=t.substring(4,6);var i=t.substring(6,7);return e+"年"+parseInt(a,10)+"月"+(i=="E"?n[0]:i=="M"?n[1]:n[2])}function h(t){var e=t.split("H");return e[0]+"年"+(e[1]==1?"上半年":"下半年")}function v(t){var e=parseInt(t,10);var a=0;if(e>=1&&e<=3){a=1}else if(e>=4&&e<=6){a=2}else if(e>=7&&e<=9){a=3}else if(e>=10&&e<=12){a=4}return a}function g(t){var e=parseInt(t,10);var a="0";if(e>=1&&e<=10){a="E"}else if(e>=11&&e<=20){a="M"}else if(e>=20){a="L"}return a}function y(t){var e=parseInt(t,10);return e<7?1:2}function b(t,e){if(t==""||t.length!=e.length){return{date:0}}var a;try{var n=t.substring(e.indexOf("Y"),e.lastIndexOf("Y")+1);var i=t.substring(e.indexOf("M"),e.lastIndexOf("M")+1);var r=t.substring(e.indexOf("D"),e.lastIndexOf("D")+1);var o=e.replace(/YYYY/,"[0-9]{4}").replace(/MM/,"[0-9]{2}").replace(/DD/,"[0-9]{2}");var l=new RegExp("^"+o+"$");if(!l.test(t))return{date:0};a={year:n,month:i,day:r,date:n+i+r}}catch(s){a={date:0}}return a}function $(t,e){if(t==""||t.length!=e.length){return{date:0}}var a;try{var n=t.substring(e.indexOf("Y"),e.lastIndexOf("Y")+1);var i=t.substring(e.indexOf("M"),e.lastIndexOf("M")+1);var r=e.replace(/YYYY/,"[0-9]{4}").replace(/MM/,"[0-9]{2}");var o=new RegExp("^"+r+"$");if(!o.test(t))return{date:0};a={year:n,month:i,date:n+i}}catch(l){a={date:0}}return a}function w(t){var e=t.split("Q");var a=e[0];var n=e[1];var i={year:a,quarter:n,date:a+n};return i}function x(t){var e=t.substring(0,4);var a=t.substring(4,6);var n=t.substring(6,7);var i={year:e,month:a,eml:n};return i}function C(t){var e=t.split("H");var a=e[0];var n=e[1];var i={year:a,half:n,date:a+n};return i}function _(t,e){for(var a=0;a<e-t.length;a++){t="0"+t}return t}function k(e){var a=t(e).datebox("options");var n=a.calendarType.toUpperCase();var i;if(n=="DATE"||n=="MONTH"||n=="YEAR"){return t(e).val()}else if(n=="QUARTER"){if(a.qnow=="0"){return""}return a.ynow+"Q"+a.qnow}else if(n=="EML"){if(a.pnow=="0"){return""}return a.ynow+a.mnow+a.pnow}else if(n=="HALFYEAR"){return a.ynow+"H"+a.hnow}}function T(e,a){var n=t(e).datebox("options");var i=n.calendarType.toUpperCase();if(i=="DATE"){if(!d(a,n.dateFormat,i)){return"日期格式不正确"}else{t(e).val(a);obj=b(a,n.dateFormat);n.ynow=obj.year;n.mnow=obj.month;n.dnow=obj.day}}else if(i=="MONTH"){if(!d(a,n.dateFormat,i)){return"日期格式不正确"}else{t(e).val(a);obj=$(a,n.dateFormat);n.ynow=obj.year;n.mnow=obj.month}}else if(i=="YEAR"){if(!d(a,n.dateFormat,i)){return"日期格式不正确"}else{t(e).val(a);n.ynow=a}}else if(i=="QUARTER"){t(e).val(f(a));obj=w(a);n.ynow=obj.year;n.qnow=obj.quarter}else if(i=="EML"){t(e).val(m(a));obj=x(a);n.ynow=obj.year;n.mnow=obj.month;n.pnow=obj.eml}else if(i=="HALFYEAR"){t(e).val(h(a));obj=C(a);n.ynow=obj.year;n.hnow=obj.half}}function S(e){var a=t(e).datebox("options");var n=a.calendarType.toUpperCase();var i={beginDate:null,endDate:null};if(n=="QUARTER"){if(a.qnow=="0"){return i}var r=["0101-0331","0401-0630","0701-0930","1001-1231"];arr=r[parseInt(a.qnow,10)-1].split("-");i.beginDate=a.ynow+arr[0];i.endDate=a.ynow+arr[1]}else if(n=="EML"){if(a.pnow=="0"){return i}var o=new Array(31,28+u(parseInt(a.ynow,10)),31,30,31,30,31,31,30,31,30,31);var l=new Array("01-10","11-20","21-"+o[parseInt(a.mnow,10)-1]);arr=l[a.pnow=="E"?"0":a.pnow=="M"?"1":"2"].split("-");i.beginDate=a.ynow+a.mnow+arr[0];i.endDate=a.ynow+a.mnow+arr[1]}else if(n=="HALFYEAR"){if(a.hnow=="0"){return i}var s=["0101-0630","0701-1231"];arr=s[parseInt(a.hnow,10)-1].split("-");i.beginDate=a.ynow+arr[0];i.endDate=a.ynow+arr[1]}return i}function I(e){var a=t(e).datebox("options");var n=a.calendarType.toUpperCase();var i=new Array(31,28+u(parseInt(a.ynow,10)),31,30,31,30,31,31,30,31,30,31);if(n!="MONTH")return null;return a.ynow+a.mnow+i[parseInt(a.mnow,10)-1]}function j(e,a){var n=t(e).datebox("options");var i=n.calendarType.toUpperCase();var r=parseInt(a.substring(0,4),10);var o=parseInt(a.substring(4,6),10);var l=parseInt(a.substring(6,8),10);var s=_(r.toString(),4);var d=_(r.toString(),4)+_(o.toString(),2);if(i=="QUARTER"){if(o>=1&&o<=3){return s+"Q1"}else if(o>=4&&o<=6){return s+"Q2"}else if(o>=7&&o<=9){return s+"Q3"}else{return s+"Q4"}}else if(i=="EML"){if(l>=1&&l<=10){return d+"E"}else if(l>=11&&l<=20){return d+"M"}else{return d+"L"}}else if(i=="HALFYEAR"){if(o<7){return s+"H1"}else{return s+"H2"}}}t.fn.datebox.defaults={calendarType:"date",showIcon:true,buttons:false,dateFormat:"YYYYMMDD",range:null,defaultDate:"",autoValidate:true,disabled:false,editable:true,scrollTarget:"body",onSelect:function(t){}};t.fn.datebox.methods={options:function(e){return t.data(e[0],"datebox").options},getDateFormat:function(e){var a=t(e).combo("datebox");return a.dateFormat},getValue:function(t){return k(t[0])},setValue:function(t,e){return t.each(function(){T(this,e)})},getDatePeriod:function(t){return S(t[0])},getLastDay:function(t){return I(t[0])},judge:function(t,e){return j(t[0],e)}};t.fn.datebox.parseOptions=function(e){var a=t(e);return t.extend({},t.parser.parseOptions(e,["calendarType","showIcon","dateFormat","editable","defaultDate","buttons"]))}})(jQuery);(function(t){t.fn.inputbox=function(a,n){if(typeof a=="string"){return t.fn.inputbox.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"inputbox");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.inputbox.defaults,t.fn.inputbox.parseOptions(this),a);r=t.data(this,"inputbox",{options:i});e(this)}})};function e(e){t(e).attr("myui-type","inputbox");var n=t.data(e,"inputbox").options;var r=t(e).attr("id");var o=t(e).width();if(n.type.toUpperCase()=="ACTION"){t(e).css("width",o-24).css("border","none");t(e).wrap('<span class="myui-inputbox-outer" style="width:'+o+'px;"></span>');t(e).after('<a class="myui-inputbox-icon '+n.icon+'"></a>')}else{t(e).css("width",o).css("border","none");t(e).wrap('<span class="myui-inputbox-outer" style="width:'+o+'px;"></span>')}if(n.maxLength!=""){t(e).attr("maxLength",n.maxLength)}else{t(e).removeAttr("maxLength")}if(n.autocomplete&&n.type.toUpperCase()=="ACTION"){t(e).parent().after('<div id="inputboxPanel_'+r+'" class="myui-inputbox-panel" style="width:'+(n.acPanelWidth==null?o:n.acPanelWidth)+"px;height:"+n.acPanelHeight+'px"></div>')}else{t(e).parent().after('<div id="inputboxPanel_'+r+'" class="myui-inputbox-panel" style="width:'+(n.acPanelWidth==null?o:n.acPanelWidth)+"px;height:"+n.acPanelHeight+'px"></div>')}if(n.autocomplete){if(n.acMode=="local"){i(e,n.acData)}else{i(e)}var l=false;n.iCount=null;var s="#inputboxPanel_"+r;if(t(s).prev().position().top+t(e).height()+2+n.acPanelHeight+t(n.acScrollTarget).scrollTop()>t(n.acScrollTarget).height()+t(n.acScrollTarget).scrollTop()+40){t(s).css("top",t(s).prev().position().top-n.acPanelHeight)}else{t(s).css("top",t(s).prev().position().top+t(e).height()+2)}t(s).css("left",t(s).prev().position().left);t(e).bind("keyup",function(i){if(i.keyCode==13&&t(s).is(":hidden")){n.onEnterDo.call(e,t(e).val())}else if(i.keyCode==13&&t(s).is(":visible")&&t(s).find("p[class='myui-inputbox-p-hover']").length<=0){n.onEnterDo.call(e,t(e).val())}else if(i.keyCode==13&&t(s).is(":visible")&&t(s).find("p[class='myui-inputbox-p-hover']").length>0){if(n.acValueInput){t(e).val(t(s).find("p[class='myui-inputbox-p-hover']").eq(0).attr("val"))}else{t(e).val(t(s).find("p[class='myui-inputbox-p-hover']").eq(0).text())}t(s).hide();if(n.iCount!=null){clearInterval(n.iCount)}}else if(i.keyCode==38&&t(s).is(":visible")){var r=t(s).find("p[class='myui-inputbox-p-hover']");if(r.length>0){t(r[0]).removeClass("myui-inputbox-p-hover");t(r[0]).prev().removeClass().addClass("myui-inputbox-p-hover").focus()}else{t(s).find("p").last().removeClass().addClass("myui-inputbox-p-hover").focus()}r=t(s).find("p[class='myui-inputbox-p-hover']");var o=t(s+" div");if(r.length>0){t(o).scrollTop(t(r[0]).offset().top-t(o).offset().top+t(o).scrollTop())}}else if(i.keyCode==40&&t(s).is(":visible")){var r=t(s).find("p[class='myui-inputbox-p-hover']");if(r.length>0){t(r[0]).removeClass("myui-inputbox-p-hover");t(r[0]).next().removeClass().addClass("myui-inputbox-p-hover").focus()}else{t(s).find("p").first().removeClass().addClass("myui-inputbox-p-hover").focus()}r=t(s).find("p[class='myui-inputbox-p-hover']");var o=t(s+" div");if(r.length>0){t(o).scrollTop(t(r[0]).offset().top-t(o).offset().top+t(o).scrollTop())}}else if(i.keyCode==8){a(e)}});t(e).bind("keyup",function(t){if(n.acData){a(e)}});t("body").bind("click",function(i){var o=i.srcElement?i.srcElement:i.target;if(t(o).attr("id")==r&&!t(s).is(":visible")&&n.clickShow){a(e)}else{t(s).hide();clearInterval(n.iCount)}})}if(n.prompt!=""){t(e).val(n.prompt)}if(!n.autocomplete){t(e).bind("keydown",function(a){if(a.keyCode==13){n.onEnterDo.call(e,t(e).val())}})}t(e).bind("focus",function(a){var i=t(e).val();if(n.prompt!=""&&i==n.prompt){t(this).val("")}}).bind("blur",function(e){if(t(this).val()==""){t(this).val(n.prompt)}});if(n.type.toUpperCase()=="ACTION"){t(e).parent().find("a").bind("click",function(a){n.onClickBtn.call(e,t(e).val())})}}function a(e){var a=t.data(e,"inputbox").options;var n=t(e).attr("id");var i="#inputboxPanel_"+n;var o=t(e).val().toUpperCase();var l=[];var s=a.textField;t.each(a.acData,function(t,e){if(a.clickShow&&e[s].toUpperCase().indexOf(o)!=-1){l.push(e)}else if(!a.clickShow&&o!=""&&e[s].toUpperCase().indexOf(o)!=-1){l.push(e)}});if(l.length>0){r(e,l);if(t(i).is(":hidden")){t(i).slideDown("200");a.iCount=setInterval(function(){if(t(i).prev().position().top+t(e).height()+2+a.acPanelHeight+t(a.acScrollTarget).scrollTop()>t(a.acScrollTarget).height()+t(a.acScrollTarget).scrollTop()+40){t(i).css("top",t(i).prev().position().top-a.acPanelHeight)}else{t(i).css("top",t(i).prev().position().top+t(e).height()+2)}t(i).css("left",t(i).prev().position().left)},100)}}else{t(i).hide();if(a.iCount!=null){clearInterval(a.iCount)}}}function n(){var e={};if(t.browser.msie){e.name="ie"}else{e.name="other"}e.version=t.browser.version;return e}function i(e,a){var n=t.data(e,"inputbox").options;if(a!=undefined){n.acData=a;n.onLoadSuccess.call(e,n.acData)}else if(n.acMode=="remote"){t.ajax({type:"post",url:n.acUrl,data:n.acParam,dataType:"json",success:function(t){n.acData=t;n.onLoadSuccess.call(e,n.acData)}})}}function r(e,a){var n=t("#inputboxPanel_"+t(e).attr("id"));var i=t.data(e,"inputbox").options;var r=i.textField;var l=i.valueField;o(e);t(n).append("<div></div>");for(var s=0;s<a.length;s++){t(n).find("div").append("<p val='"+a[s][l]+"'>"+a[s][r]+"</p>")}t(n).find("p").bind("click",function(a){t(e).focus();t(n).hide();if(i.acValueInput){t(e).val(t(this).attr("val"))}else{t(e).val(t(this).text())}a.stopPropagation()});t(n).find("p").bind("mouseenter",function(e){t(this).removeClass().addClass("myui-inputbox-p-hover");e.stopPropagation()}).bind("mouseleave",function(e){t(this).removeClass();e.stopPropagation()})}function o(e){var a=t("#inputboxPanel_"+t(e).attr("id"));var n=t.data(e,"inputbox").options;t(a).empty()}function l(e){return t(e).val()}function s(e,a){t(e).val(a)}function d(e){var a=t.data(e,"inputbox").options;var n=null;var i=t(e).val();t.each(a.acData,function(t,e){if(e[a.textField]==i){n=e[a.valueField];return}});return n}function u(e,a){var n=t.data(e,"inputbox").options;var i=null;t.each(n.acData,function(t,e){if(e[n.valueField]==a){i=e[n.textField];return}});return i}function c(e,a){var n=t.data(e,"inputbox").options;var i=null;t.each(n.acData,function(t,e){if(e[n.textField]==a){i=e[n.valueField];return}});return i}function p(e){var a=t.data(e,"inputbox").options;a.onEnterDo.call(e,t(e).val())}t.fn.inputbox.defaults={type:"normal",autocomplete:false,acMode:"local",acUrl:"",acParam:null,acData:null,acPanelHeight:200,acPanelWidth:null,acValueInput:false,clickShow:false,textField:"text",valueField:"value",acScrollTarget:"body",maxLength:"",prompt:"",icon:"",onLoadSuccess:function(t){},onEnterDo:function(t){},onClickBtn:function(t){return p(this)}};t.fn.inputbox.methods={options:function(e){return t.data(e[0],"inputbox").options},getText:function(t){return l(t[0])},setText:function(t,e){return t.each(function(){s(this,e)})},getValue:function(t){return d(t[0])},getValueByText:function(t,e){return c(t[0],e)},getTextByValue:function(t,e){return u(t[0],e)},loadData:function(t,e){return t.each(function(){i(this,e)})}};t.fn.inputbox.parseOptions=function(e){var a=t(e);return t.extend({},t.parser.parseOptions(e,["type","prompt","icon"]))}})(jQuery);(function(t){t.fn.popselector=function(a,n){if(typeof a=="string"){return t.fn.popselector.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"popselector");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.popselector.defaults,t.fn.popselector.parseOptions(this),a);r=t.data(this,"popselector",{options:i});e(this)}})};function e(e){t(e).attr("myui-type","popselector");var n=t.data(e,"popselector").options;var i=null;t(e).attr("readonly","readonly").css("cursor","pointer");if(n.openOnParent){t("body",parent.document).append("<div id='popselectorWin'></div>");i=t("#popselectorWin",parent.document)}else{t("body").append("<div id='popselectorWin'></div>");i=t("#popselectorWin")}if(n.url!=null){t.ajax({url:n.url,type:"post",dataType:"json",data:n.param,async:false,success:function(t){n.data=t;o(e,n.defaultValue)}})}else{o(e,n.defaultValue)}t(e).bind("click",function(r){if(!n.beforeOpen.call(e)){return}var o=window.document.location.pathname;var l=o.substring(0,o.substr(1).indexOf("/")+1);var s=l+"/mybi/common/components/myui_popselector/popselector-"+n.type.toLowerCase()+".jsp?openOnParent="+(n.openOnParent?"true":"false")+"&tId="+t(e).attr("id")+"&frameName="+window.name;t(i).window({open:true,headline:n.winTitle,top:n.winTop,left:a(n.winWidth,n.openOnParent),content:'<iframe name="popselector" src='+s+' scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:n.winWidth,panelHeight:n.winHeight})})}function a(e,a){if(!a){return""}var n=t("body",parent.document).width();return(n-e)*.5}function n(e){var a=t(e).popselector("options");return a.realValue}function i(e){var a=t(e).popselector("options");return a.showText}function r(e){var a=t(e).popselector("options");return a.selNode}function o(e,a){var n=t(e).popselector("options");if(a==null||a==undefined){n.realValue=null;n.showText="";return}var i=n.data;n.realValue=a;var r="";if(n.type.toUpperCase()=="RADIO"){t.each(i,function(t,e){if(e[n.valueField]==a){r=e[n.textField];return}})}else if(n.type.toUpperCase()=="CHECKBOX"){var o=a.split(",");t.each(i,function(e,a){t.each(o,function(t,e){if(e==a[n.valueField]){r+=a[n.textField]+",";return}})});if(r!=""){r=r.substring(0,r.length-1)}}else if(n.type.toUpperCase()=="TREE-RADIO"){t.each(i,function(t,e){if(e.id==a){r=e.name;return}})}else if(n.type.toUpperCase()=="TREE-CHECKBOX"){var o=a.split(",");t.each(i,function(e,a){t.each(o,function(t,e){if(e==a.id){r+=a.name+",";return}})});if(r!=""){r=r.substring(0,r.length-1)}}n.showText=r;if(n.inputValue){t(e).val(a)}else{t(e).val(r)}}function l(e,a){var n=t(e).popselector("options");n.data=a}t.fn.popselector.defaults={type:"checkbox",url:null,param:{},data:null,openOnParent:false,winTitle:"选择",winWidth:400,winHeight:400,winTop:70,oneLineCount:1,valueField:"value",textField:"text",treeShowIcon:false,inputValue:false,defaultValue:null,beforeOpen:function(){return true},afterSubmit:function(){}};t.fn.popselector.methods={options:function(e){return t.data(e[0],"popselector").options},getData:function(e){var a=t(e).popselector("options");return a.data},getValue:function(t){return n(t[0])},getText:function(t){return i(t[0])},getRadioTreeSelectedNode:function(t){return r(t[0])},setValue:function(t,e){return t.each(function(){o(this,e)})},loadData:function(t,e){return t.each(function(){l(this,e)})}};t.fn.popselector.parseOptions=function(e){return t.extend({},t.parser.parseOptions(e,["url","param","data","openOnParent","winTitle","winHeight","winWidth","oneLineCount","valueField","textField","treeShowIcon","inputValue","defaultValue","beforeOpen"]))}})(jQuery);(function(t){t.validator={style:"hover",position:"right",validateOnBlur:true,init:function(e){t.extend(true,this,e);var a=t(".myui-validator");if(a.length){if(a["validator"]){a["validator"]()}}return this},addValidType:function(e,a,n){var i={};i[e]={validator:n,message:a};t.extend(t.fn.validator.defaults.rules,i);return this}}})(jQuery);(function($){$.fn.validator=function(t,e){if(typeof t=="string"){return $.fn.validator.methods[t](this,e)}t=t||{};return this.each(function(){var e;var a=$.data(this,"validator");if(a){e=$.extend(a.options,t);create(this)}else{e=$.extend({},$.fn.validator.defaults,$.fn.validator.parseOptions(this),t);a=$.data(this,"validator",{options:e});create(this)}})};function create(t){var e=$.data(t,"validator").options;var a=$(t).attr("id");if(!$(t).hasClass("myui-validator")){$(t).addClass("myui-validator")}if($.validator.style.toUpperCase()=="HOVER"){var n=$.validator.position.toLowerCase();var i="myui-validator-hover-"+n;var r=a+"_validator_hover";$(t).before("<div id='"+r+"' class='"+i+"'></div>");setAbsPos(t,$("#"+r),n);$("*").scroll(function(){setAbsPos(t,$("#"+r),n)});$("#"+r).hide();$(t).bind("focus",function(t){$("#"+r).hide()});if($.validator.validateOnBlur){$(t).bind("blur",function(e){var a=validate(t);if(!a){setAbsPos(t,$("#"+r),n);$("#"+r).show()}})}}}function setAbsPos(t,e,a){var n=$(t).position().top;var i=$(t).position().left;if(a=="top"){$(e).css("top",n-$(e).height()-5)}else if(a=="bottom"){$(e).css("top",n+30)}else if(a=="right"){if($(t).parent().hasClass("myui-combo-outer")||$(t).parent().hasClass("myui-inputbox-outer")){$(e).css("left",i+$(t).width()+33)}else{$(e).css("left",i+$(t).width()+10)}$(e).css("top",n)}else if(a=="left"){$(e).css("top",n);$(e).css("left",i-110)}}function validate(target){var opts=$.data(target,"validator").options;var value=null;var myuiType=$(target).attr("myui-type");if(myuiType=="combo"){var type=$(target).combo("options").comboType;if(type=="normal-single"){value=$(target).combo("getValue")}else{value=$(target).combo("getValues").join(",")}}else if(myuiType=="datebox"){value=$(target).datebox("getValue")}else if(myuiType=="popselector"){value=$(target).popselector("getValue")}else if(myuiType=="multinput"){value=$(target).multinput("getValue")}else if(myuiType=="multinput2"){value=$(target).multinput2("getValue")}else{value=$(target).val()}if(opts.validateDisabled){return true}if(opts.required&&(value==null||value=="")){setErrorMsg(target,"该项不能为空。");return false}if(value!=null&&value!=""){if(opts.validType!=null&&!(opts.validType instanceof Array)){opts.validType=eval(opts.validType)}if(opts.validType!=null&&opts.validType.length>0){var validType=opts.validType;var validFlag;for(var i=0;i<validType.length;i++){validFlag=false;validObj=parseValidType(validType[i]);validFlag=opts.rules[validObj.validType].validator.call(target,value,validObj.param);if(!validFlag){setErrorMsg(target,transMessage(opts.rules[validObj.validType].message,validObj.param));return false}}}}return true}function setErrorMsg(t,e){if($.validator.style.toUpperCase()=="ALERT"){$.messager.alert(myjs_getI18n("i18n_info"),e,"info")}else if($.validator.style.toUpperCase()=="HOVER"){var a=$.validator.position.toLowerCase();var n=$(t).attr("id");var i=n+"_validator_hover";setAbsPos(t,$("#"+i),a);$("#"+i).text(e);$("#"+i).show()}}function parseValidType(t){var e={};if(t.indexOf("(")>0){e.validType=t.substring(0,t.indexOf("("));e.param=t.substring(t.indexOf("(")+1,t.length-1).replace(/\s+/g,"").split(",")}else{e.validType=t;e.param=null}return e}function transMessage(t,e){if(t==undefined||t==null){return"输入错误"}var a=/{\d}/g;var n=t.match(a);var i=t+"";if(n!=null&&n.length>0){for(var r=0;r<n.length;r++){i=i.replace(n[r],e[r])}return i}return t}function setValidateDisabled(t,e){var a=$.data(t,"validator").options;a.validateDisabled=e}function resetErrMsg(t,e){var a=$.data(t,"validator").options;a.rules[e.ruleName].message=e.message}$.fn.validator.methods={options:function(t){return $.data(t[0],"validator").options},validate:function(t){var e=true;if($.validator.style.toUpperCase()=="ALERT"){t.each(function(){if(!validate(this)){e=false;return}})}else{t.each(function(){if(!validate(this)){e=false}})}return e},setValidateDisabled:function(t,e){return t.each(function(){setValidateDisabled(this,e)})},resetErrMsg:function(t,e){return t.each(function(){resetErrMsg(this,e)})}};$.fn.validator.defaults={required:false,validType:null,validateDisable:false,rules:{minLength:{validator:function(t,e){t=$.trim(t);return t.length>=e[0]},message:"最少输入{0}个字符。"},maxLength:{validator:function(t,e){t=$.trim(t);return t.length<=e[0]},message:"最多输入{0}个字符。"},length:{validator:function(t,e){t=$.trim(t);return t.length<=e[1]&&t.length>=e[0]},message:"请输入{0}至{1}个字符。"},mobile:{validator:function(t){return/^(13|15|18)\d{9}$/i.test(t)},message:"手机号码格式不正确"},idcard:{validator:function(t){return/^\d{15}(\d{2}[A-Za-z0-9])?$/i.test(t)||/^\d{18}(\d{2}[A-Za-z0-9])?$/i.test(t)},message:"身份证号码格式不正确"},number:{validator:function(t){return/^[-]{0,1}\d+(\.\d+)?$/i.test(t)},message:"请输入数字，并确保格式正确"},qq:{validator:function(t){return/^[1-9]\d{4,9}$/i.test(t)},message:"QQ号码格式不正确"},integer:{validator:function(t){return/^(0|[1-9]\d*)$/i.test(t)},message:"请输入整数"},pinteger:{validator:function(t){return/^[1-9]\d*$/i.test(t)},message:"请输入正整数"},chn:{validator:function(t){return/^[\u0391-\uFFE5]+$/i.test(t)},message:"请输入中文"},eng:{validator:function(t){return/^[A-Za-z]+$/i.test(t)},message:"请输入英文"},engUpperCase:{validator:function(t){return/^[A-Z]+$/.test(t)},message:"请输入大写英文"},nospace:{validator:function(t){return/^[^ 　]+$/i.test(t)},message:"输入值不能包含空格"},username:{validator:function(t){return/^[a-zA-Z][a-zA-Z0-9_]{5,15}$/i.test(t)},message:"用户名不合法（字母开头，允许6-16个字符，允许字母数字下划线）"},zip:{validator:function(t){return/^[1-9]\d{5}$/i.test(t)},message:"邮政编码格式不正确"},ip:{validator:function(t){return/d+.d+.d+.d+/i.test(t)},message:"IP地址格式不正确"},name:{validator:function(t){return/^[\u0391-\uFFE5]+$/i.test(t)||/^\w+[\w\s]+\w+$/i.test(t)},message:"请输入姓名，可以是中文或英文"},same:{validator:function(t,e){if($("#"+e[0]).val()!=""&&t!=""){return $("#"+e[0]).val()==t}else{return true}},message:"两次输入的密码不一致!"},variable:{validator:function(t){return/^[a-zA-Z][a-zA-Z0-9_]*$/i.test(t)},message:"输入不合法，字母开头，允许字母数字下划线"},indcde:{validator:function(t){return/^[A-Z][A-Z0-9]*$/i.test(t)},message:"输入不合法，大写字母开头，允许大写字母数字"}}};$.fn.validator.parseOptions=function(t){return $.extend({},$.parser.parseOptions(t,["required","validType"]))}})(jQuery);(function(t){t.fn.form=function(a,n){if(typeof a=="string"){return t.fn.form.methods[a](this,n)}a=a||{};return this.each(function(){if(!t.data(this,"form")){t.data(this,"form",{options:t.extend({},t.fn.form.defaults,a)})}e(this)})};function e(e){var n=t.data(e,"form").options;t(e).unbind(".form").bind("submit.form",function(){setTimeout(function(){a(e,n)},0);return false})}function a(e,a){a=a||{};var i={};if(a.onSubmit){if(a.onSubmit.call(e,i)==false){return}}add_onload();var r=t(e);var o=a.url==null?r.attr("action"):a.url;var l=n(e);var s=a.bindJavaObj;var d=a.otherParam;for(var u in l){if(s!=null&&s!=""){i[s+"."+u]=l[u]}else{i[u]=l[u]}}if(d!=null){for(var c in d){i[c]=d[c]}}t.post(o,i,function(t){clean_onload();a.success.call(e,t)},"json")}function n(e){var a={};var n=t(e).find("input:text,input[type='hidden'],input:password,textarea");t.each(n,function(e,n){if(t(n).attr("name")!=undefined&&t(n).attr("name")!=""){var i=t(n).attr("name");var r=t(n).attr("myui-type");if(r=="combo"){var o=t(n).combo("options").comboType;if(o=="normal-single"){a[i]=t(n).combo("getValue")}else{a[i]=t(n).combo("getValues").join(",")}}else if(r=="datebox"){a[i]=t(n).datebox("getValue")}else if(r=="popselector"){a[i]=t(n).popselector("getValue")}else if(r=="multinput"){a[i]=t(n).multinput("getValue").join(",")}else if(r=="multinput2"){a[i]=t(n).multinput2("getValue").join(",")}else{a[i]=t(n).val()}}});n=t(e).find("input[type='checkbox']");var i=[];t.each(n,function(n,r){if(t(r).attr("name")!=undefined&&t(r).attr("name")!=""){var o=t(r).attr("name");if(t.inArray(o,i)==-1){i.push(o);var l=t(e).find("input[type='checkbox'][name='"+o+"']:checked");var s=[];for(var d=0;d<l.length;d++){s.push(t(l[d]).val())}a[o]=s.join(",")}}});n=t(e).find("input[type='radio']");i=[];t.each(n,function(n,r){if(t(r).attr("name")!=undefined&&t(r).attr("name")!=""){var o=t(r).attr("name");if(t.inArray(o,i)==-1){i.push(o);var l=t(e).find("input[type='radio'][name='"+o+"']:checked");a[o]=t(l).val()}}});n=t(e).find("select");t.each(n,function(e,n){
if(t(n).attr("name")!=undefined&&t(n).attr("name")!=""){var i=t(n).attr("name");a[i]=t(n).find("option:selected").val()}});n=t(e).find("ul[class='seltile']");t.each(n,function(e,n){if(t(n).attr("name")!=undefined&&t(n).attr("name")!=""){var i=t(n).attr("name");a[i]=t(n).find("li[class='option_selected']").attr("val")}});return a}function i(e){var a=t(e).find(".myui-validator").not(":disabled");return t(e).find(".myui-validator").not(":disabled").validator("validate")}t.fn.form.methods={submit:function(e,n){return e.each(function(){var e=t.extend({},t.fn.form.defaults,t.data(this,"form")?t.data(this,"form").options:{},n||{});a(this,e)})},validate:function(t){return i(t[0])}};t.fn.form.defaults={url:null,bindJavaObj:null,otherParam:null,onSubmit:function(e){return t(this).form("validate")},success:function(t){}}})(jQuery);(function(t){t.fn.tooltip=function(e,n){if(typeof e=="string"){return t.fn.tooltip.methods[e](this,n)}e=e||{};return this.each(function(){var n;var i=t.data(this,"tooltip");if(i){n=t.extend(i.options,e);a(this)}else{n=t.extend({},t.fn.tooltip.defaults,t.fn.tooltip.parseOptions(this),e);i=t.data(this,"tooltip",{options:n});a(this)}})};function e(){var t=[];var e="0123456789abcdef";for(var a=0;a<36;a++){t[a]=e.substr(Math.floor(Math.random()*16),1)}t[14]="4";t[19]=e.substr(t[19]&3|8,1);t[8]=t[13]=t[18]=t[23]="-";var n=t.join("");return n}function a(a){var i=t.data(a,"tooltip").options;i.hId=e();t(a).before("<div id='"+i.hId+"' class='myui-tooltip-div'></div>");var r=t("#"+i.hId);if(i.css!=null){var o=i.css.split(";");t.each(o,function(e,a){if(a!=""){var n=a.split(":");t(r).css(n[0],n[1])}})}if(i.content!=""){t(r).html(i.content);t(r).hide();var l=false;var s=false;var d=t(a);if(i.selector){d=t(i.selector)}if(i.trigger.toUpperCase()=="CLICK"){d.bind("click",function(e){e.stopPropagation();l=true;i.timeout=setTimeout(function(){if(l){if(!i.beforeTipShow.call(a)){return}n(a,r);t(r).fadeIn("100");i.afterTipShow.call(a)}},200)}).bind("mouseleave",function(e){e.stopPropagation();l=false;i.timeout=setTimeout(function(){if(!s){if(!i.beforeTipHide.call(a)){return}t(r).fadeOut("100");i.afterTipHide.call(a)}},200)})}else if(i.trigger.toUpperCase()=="HOVER"){d.bind("mouseenter",function(e){e.stopPropagation();l=true;i.timeout=setTimeout(function(){if(l){if(!i.beforeTipShow.call(a)){return}n(a,r);t(r).fadeIn("100");i.afterTipShow.call(a)}},200)}).bind("mouseleave",function(e){e.stopPropagation();l=false;i.timeout=setTimeout(function(){if(!s){if(!i.beforeTipHide.call(a)){return}t(r).fadeOut("100");i.afterTipHide.call(a)}},200)})}else if(i.trigger.toUpperCase()=="FOCUS"){d.bind("focusin",function(e){e.stopPropagation();l=true;i.timeout=setTimeout(function(){if(l){if(!i.beforeTipShow.call(a)){return}n(a,r);t(r).fadeIn("100");i.afterTipShow.call(a)}},200)}).bind("focusout",function(e){e.stopPropagation();l=false;i.timeout=setTimeout(function(){if(!s){if(!i.beforeTipHide.call(a)){return}t(r).fadeOut("100");i.afterTipHide.call(a)}},200)})}t(r).bind("mouseenter",function(t){t.stopPropagation();s=true}).bind("mouseleave",function(e){e.stopPropagation();s=false;i.timeout=setTimeout(function(){if(!l){if(!i.beforeTipHide.call(a)){return}t(r).fadeOut("100");i.afterTipHide.call(a)}},200)})}}function n(e,a){var n=t(e).position().top;var i=t(e).position().left;var r=t(e).height();if(n+r+t(a).height()+5>t("body").height()){t(a).css("top",n-t(a).height()-5)}else{t(a).css("top",n+r+5)}if(i+t(a).width()>t("body").width()){var o=i+t(a).width()-t("body").width();t(a).css("left",i-o-10)}else{t(a).css("left",i)}}function i(e,a){var n=t(e).tooltip("options");n.content=a;t("#"+n.hId).html(a)}t.fn.tooltip.defaults={content:"",css:null,selector:false,trigger:"hover",beforeTipShow:function(){return true},beforeTipHide:function(){return true},afterTipShow:function(){},afterTipHide:function(){}};t.fn.tooltip.methods={options:function(e){return t.data(e[0],"tooltip").options},setContent:function(t,e){return t.each(function(){i(this,e)})}};t.fn.tooltip.parseOptions=function(e){return t.extend({},t.parser.parseOptions(e,["content","css","selector","trigger","onTipShow","onTipHide"]))}})(jQuery);(function(t){t.fn.cycle=function(a,n){if(typeof a=="string"){return t.fn.cycle.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"cycle");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.cycle.defaults,t.fn.cycle.parseOptions(this),a);r=t.data(this,"cycle",{options:i});e(this)}})};function e(e){t(e).attr("myui-type","cycle");var i=t.data(e,"cycle").options;var r=null;t(e).attr("readonly","readonly").css("cursor","pointer");if(i.openOnParent){t("body",parent.document).append("<div id='cycleWin'></div>");r=t("#cycleWin",parent.document)}else{t("body").append("<div id='cycleWin'></div>");r=t("#cycleWin")}n(e,i.defaultValue);t(e).bind("click",function(n){if(!i.beforeOpen.call(e)){return}var o=window.document.location.pathname;var l=o.substring(0,o.substr(1).indexOf("/")+1);var s=l+"/mybi/common/components/myui_cycle/cycle.jsp?openOnParent="+(i.openOnParent?"true":"false")+"&tId="+t(e).attr("id")+"&frameName="+window.name;t(r).window({open:true,headline:"周期选择",top:70,left:a(i.winWidth,i.openOnParent),content:'<iframe name="cycleFrame" src='+s+' scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:450,panelHeight:290})})}function a(e,a){if(!a){return""}var n=t("body",parent.document).width();return(n-e)*.5}function n(e,a){var n=t(e).cycle("options");if(a==null||a==undefined){n.cycleValue=null;return}n.cycleValue=a;t(e).val(a==null?"":a)}t.fn.cycle.defaults={openOnParent:false,defaultValue:null,beforeOpen:function(){return true}};t.fn.cycle.methods={options:function(e){return t.data(e[0],"cycle").options}};t.fn.cycle.parseOptions=function(e){return t.extend({},t.parser.parseOptions(e,["openOnParent","defaultValue","beforeOpen"]))}})(jQuery);(function(t){t.fn.multinput=function(a,n){if(typeof a=="string"){return t.fn.multinput.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"multinput");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.multinput.defaults,t.fn.multinput.parseOptions(this),a);r=t.data(this,"multinput",{options:i});e(this)}})};function e(e){t(e).attr("myui-type","multinput");var o=t.data(e,"multinput").options;var l=t(e).attr("id");t(e).wrap("<div class='myui-multinput-container' style='width:"+t(e).width()+"px;max-height:"+o.maxHeight+"px;'></div>");t(e).css({border:"1px solid #FBFBFB","background-color":"#FBFBFB","font-family":"微软雅黑","font-size":"12px",height:"20px",outline:"none"});t(e).width(18);t(e).parent().bind("click",function(a){t(e).focus()});var s=setInterval(function(){if(t(e).val().length>0){var a=n(t(e).val());var r=i(t(e).val());var o=a*12+r*8+(t(e).val().length-a-r)*6;if(o>t(e).parent().width()){t(e).width(t(e).parent().width()-2)}else{t(e).width(o)}}else{t(e).width(18)}},200);t(e).bind("keyup",function(a){if((a.keyCode==8||a.keyCode==46)&&t.trim(t(e).val()).length==0){if(t(e).parent().find("ol").length==0){return}if(t(e).parent().find("ol li.myui-multinput-item-selected").length==0){t(e).parent().find("ol li").last().addClass("myui-multinput-item-selected")}else{t(e).parent().find("ol li.myui-multinput-item-selected").remove()}}else if(a.keyCode==38){if(t(e).parent().find("ol").length==0){return}if(t(e).parent().find("ol li.myui-multinput-item-selected").length==0){t(e).parent().find("ol li").last().addClass("myui-multinput-item-selected")}else{t(e).parent().find("ol li.myui-multinput-item-selected").eq(0).removeClass("myui-multinput-item-selected").prev().addClass("myui-multinput-item-selected")}}else if(a.keyCode==40){if(t(e).parent().find("ol").length==0){return}if(t(e).parent().find("ol li.myui-multinput-item-selected").length==0){t(e).parent().find("ol li").first().addClass("myui-multinput-item-selected")}else{t(e).parent().find("ol li.myui-multinput-item-selected").eq(0).removeClass("myui-multinput-item-selected").next().addClass("myui-multinput-item-selected")}}else{t(e).parent().find("ol li").removeClass("myui-multinput-item-selected")}});t(e).bind("keypress",function(n){if(t.inArray(n.keyCode,o.confirmKeyCode)!=-1&&t.trim(t(e).val()).length>0){a(e)}});t(e).bind("blur",function(n){if(t.trim(t(e).val()).length>0){a(e)}});t(e).bind("paste",function(n){var i=n.originalEvent;var r=i.clipboardData;var l=null;var s=window.clipboardData;if(!s){s=n.originalEvent.clipboardData}l=s.getData("Text");var d=l.split(o.pasteSeprator);t.each(d,function(n,i){if(t.trim(i)!=""){a(e,i)}});n.preventDefault()});if(o.defaultValue!=null){r(e,o.defaultValue)}}function a(e,a){var n=t(e).attr("id");var i=a?a:t.trim(t(e).val());if(t(e).parent().find("ol").length>0){t(e).parent().find("ol").append("<li class='myui-multinput-item'>"+i+"<a href='javascript:void(0)' class='myui-multinput-remove'>X</a><input type='hidden' value='"+i+"'/></li>")}else{t(e).before("<ol id='mi_"+n+"_list' class='myui-multinput-list'><li class='myui-multinput-item'>"+i+"<a href='javascript:void(0)' class='myui-multinput-remove'>X</a><input type='hidden' value='"+i+"'/></li></ol>")}t(e).parent().find(".myui-multinput-remove").on("click",function(e){t(this).parent().remove();e.stopPropagation()});t(e).parent().find(".myui-multinput-item").on("click",function(a){t(e).parent().find("ol li").removeClass("myui-multinput-item-selected");t(this).addClass("myui-multinput-item-selected");a.stopPropagation()});t(e).val("")}function n(t){var e=/[^\u4E00-\u9FA5\uf900-\ufa2d]/g;var a=t.replace(e,"");return a.length}function i(t){var e=/[^0-9]/g;var a=t.replace(e,"");return a.length}function r(e,n){var i=t(e).multinput("options");if(n){t(e).parent().find("ol").remove();t.each(n,function(t,n){a(e,n)})}}function o(e){var a=t(e).multinput("options");var n=t(e).parent().find("ol li input:hidden");var i=[];if(n.length!=0){t.each(n,function(e,a){i.push(t(a).val())})}return i}t.fn.multinput.defaults={maxHeight:200,confirmKeyCode:[13,32],pasteSeprator:" ",defaultValue:null};t.fn.multinput.methods={options:function(e){return t.data(e[0],"multinput").options},getValue:function(t){return o(t[0])},setValue:function(t,e){return t.each(function(){r(this,e)})}};t.fn.multinput.parseOptions=function(e){return t.extend({},t.parser.parseOptions(e,["maxHeight","confirmKeyCode","pasteSeprator"]))}})(jQuery);(function(t){t.fn.multinput2=function(a,n){if(typeof a=="string"){return t.fn.multinput2.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"multinput2");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.multinput2.defaults,t.fn.multinput2.parseOptions(this),a);r=t.data(this,"multinput2",{options:i});e(this)}})};function e(e){t(e).attr("myui-type","multinput2");var o=t.data(e,"multinput2").options;var l=t(e).width();var s=t(e).attr("id");t(e).css({"line-height":"22px",height:"22px",border:"1px solid #D2D2D2","background-color":"#FBFBFB","text-indent":"3px","font-family":"微软雅黑","font-size":"14px",cursor:"pointer",color:"#999"});t(e).attr("readonly","readonly");t(e).after('<div id="multinputPanel_'+s+'" class="myui-comboSD-panel" style="width:'+(o.panelWidth==null?l:o.panelWidth)+"px;height:"+o.panelHeight+'px;"></div>');var d="<div class='myui-comboSD-panel-div' style='height:"+(o.panelHeight-33)+"px;overflow-y:auto;font-family:微软雅黑;background-color:#FBFBFB'><input id='multinputInput_"+s+"' style='font-family:微软雅黑;font-size:12px;height:22px;outline:none;width:18px;border:none;background-color:#FBFBFB'/></div>";d+="<div class='myui-comboSD-btnZone'><table style='width:100%' cellpadding='0' cellspacing='0'><tr style='height:30px'><td align='left' style='padding:5px 0 5px 5px;font-family:微软雅黑;font-size:12px;'>粘贴分隔符：<select id='multinputSep_"+s+"' style='height:22px;'><option value='space'>空格</option><option value='enter'>回车</option><option value='tab'>制表</option><option value='comma'>逗号</option><option value='semicolon'>分号</option><option value='vline'>竖线</option></select></td><td align='right' style='padding:5px 0'><a id='multinputCopy_"+s+"' class='myui-comboSD-btn' href='javascript:void(0)'>复制</a><a id='multinputPaste_"+s+"' class='myui-comboSD-btn' href='javascript:void(0)'>粘贴</a><a id='multinputClear_"+s+"' class='myui-comboSD-btn' href='javascript:void(0)'>清空</a></td></tr></table></div>";var u="#multinputPanel_"+s;t(u).append(d);var c=false;o.iCount=null;o.timer=null;t(e).bind("click",function(a){if(t(u).css("display")!="none"){t(u).hide();clearInterval(o.iCount)}else{t.each(t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel"),function(e){if(t(this).css("display")!="none"){c=true}});if(c){t(".myui-combo-panel-normal,.myui-comboSD-panel,.myui-datebox-panel").hide();clearInterval(o.iCount)}t(u).slideDown("300");t(u).find("input:visible").focus();o.iCount=setInterval(function(){if(t(u)==undefined||t(u)==null){clearInterval(o.iCount)}if(t(u).prev().position().top+t(e).height()+2+o.panelHeight+t(o.scrollTarget).scrollTop()>t(o.scrollTarget).height()+t(o.scrollTarget).scrollTop()+40){t(u).css("top",t(u).prev().position().top-o.panelHeight)}else{t(u).css("top",t(u).prev().position().top+t(e).height()+2)}t(u).css("left",t(u).prev().position().left)},100)}a.stopPropagation()});var p=t("#multinputInput_"+s);p.parent().bind("click",function(e){t(p).focus()});t(u).bind("click",function(t){t.stopPropagation()});t("body").bind("click",function(e){t(u).hide();clearInterval(o.iCount)});o.timer=setInterval(function(){if(t(p).val().length>0){var e=n(t(p).val());var a=i(t(p).val());var r=e*12+a*8+(t(p).val().length-e-a)*6;if(r>t(p).parent().width()){t(p).width(t(p).parent().width()-2)}else{t(p).width(r)}}else{t(p).width(18)}},200);t(p).on("keyup",function(a){if((a.keyCode==8||a.keyCode==46)&&t.trim(t(p).val()).length==0){if(t(p).parent().find("ol").length==0){return}if(t(p).parent().find("ol li.myui-multinput-item-selected").length==0){t(p).parent().find("ol li").last().addClass("myui-multinput-item-selected")}else{t(p).parent().find("ol li.myui-multinput-item-selected").remove()}t(e).val("已输入"+t(p).parent().find("ol li").length+"个值，点击编辑")}else if(a.keyCode==38){if(t(p).parent().find("ol").length==0){return}if(t(p).parent().find("ol li.myui-multinput-item-selected").length==0){t(p).parent().find("ol li").last().addClass("myui-multinput-item-selected")}else{t(p).parent().find("ol li.myui-multinput-item-selected").eq(0).removeClass("myui-multinput-item-selected").prev().addClass("myui-multinput-item-selected")}}else if(a.keyCode==40){if(t(p).parent().find("ol").length==0){return}if(t(p).parent().find("ol li.myui-multinput-item-selected").length==0){t(p).parent().find("ol li").first().addClass("myui-multinput-item-selected")}else{t(p).parent().find("ol li.myui-multinput-item-selected").eq(0).removeClass("myui-multinput-item-selected").next().addClass("myui-multinput-item-selected")}}else{t(p).parent().find("ol li").removeClass("myui-multinput-item-selected")}if(t.inArray(44,o.confirmKeyCode)!=-1){t(p).val(t(p).val().replace(",",""))}});t(p).on("keypress",function(n){if(t.inArray(n.keyCode,o.confirmKeyCode)!=-1&&t.trim(t(p).val()).length>0){a(e,p)}});t(p).on("blur",function(n){if(t.trim(t(p).val()).length>0){a(e,p)}});var f={enter:"\r",space:" ",tab:"\t",comma:",",vline:"|",semicolon:";"};var m=t("#multinputCopy_"+s);var h=t("#multinputPaste_"+s);var v=t("#multinputSep_"+s);var g=t("#multinputClear_"+s);t(v).find("option[value='"+o.defaultSeprator+"']").attr("selected",true);t(p).on("paste",function(n){var i=n.originalEvent;var r=i.clipboardData;var o=null;var l=window.clipboardData;if(!l){l=n.originalEvent.clipboardData}o=l.getData("Text");var s=o.split(f[t(v).val()]);t.each(s,function(n,i){if(t.trim(i)!=""){a(e,p,i)}});n.preventDefault()});t(h).bind("click",function(n){var i=window.clipboardData.getData("Text");var r=i.split(f[t(v).val()]);t.each(r,function(n,i){if(t.trim(i)!=""){a(e,p,i)}});n.preventDefault()});t(m).bind("click",function(a){var n=t(e).multinput2("getValue").join(f[t(v).val()]);window.clipboardData.setData("Text",n)});t(g).bind("click",function(t){r(e,[])});if(o.defaultValue!=null){r(e,o.defaultValue)}}function a(e,a,n){var i=t(a).attr("id");var r=n?n:t.trim(t(a).val());if(t(a).parent().find("ol").length>0){t(a).parent().find("ol").append("<li class='myui-multinput-item'>"+r+"<a href='javascript:void(0)' class='myui-multinput-remove'>X</a><input type='hidden' value='"+r+"'/></li>")}else{t(a).before("<ol class='myui-multinput-list'><li class='myui-multinput-item'>"+r+"<a href='javascript:void(0)' class='myui-multinput-remove'>X</a><input type='hidden' value='"+r+"'/></li></ol>")}t(a).parent().find(".myui-multinput-remove").on("click",function(n){t(this).parent().remove();t(e).val("已输入"+t(a).parent().find("ol li").length+"个值，点击编辑");n.stopPropagation()});t(a).parent().find(".myui-multinput-item").on("click",function(e){t(a).parent().find("ol li").removeClass("myui-multinput-item-selected");t(this).addClass("myui-multinput-item-selected");e.stopPropagation()});t(a).val("");var o=i.substring(i.indexOf("_")+1);t("#"+o).val("已输入"+t(a).parent().find("ol li").length+"个值，点击编辑")}function n(t){var e=/[^\u4E00-\u9FA5\uf900-\ufa2d]/g;var a=t.replace(e,"");return a.length}function i(t){var e=/[^0-9]/g;var a=t.replace(e,"");return a.length}function r(e,n){var i=t(e).multinput2("options");var r=t(e).attr("id");var o=t("#multinputInput_"+r);if(n){t(o).parent().find("ol").remove();t.each(n,function(t,e){a(o,e)});t(e).val("已输入"+n.length+"个值，点击编辑")}}function o(e){var a=t(e).multinput2("options");var n=t(e).attr("id");var i=t("#multinputInput_"+n);var r=t(i).parent().find("ol li input:hidden");var o=[];if(r.length!=0){t.each(r,function(e,a){o.push(t(a).val())})}return o}t.fn.multinput2.defaults={panelHeight:200,panelWidth:300,defaultValue:null,scrollTarget:"body",confirmKeyCode:[13,32,44],defaultSeprator:"comma"};t.fn.multinput2.methods={options:function(e){return t.data(e[0],"multinput2").options},getValue:function(t){return o(t[0])},setValue:function(t,e){return t.each(function(){r(this,e)})}};t.fn.multinput2.parseOptions=function(e){return t.extend({},t.parser.parseOptions(e,["panelHeight","panelWidth","scrollTarget","confirmKeyCode"]))}})(jQuery);(function($){$.fn.datagrid2=function(t,e){if(typeof t=="string"){return $.fn.datagrid2.methods[t](this,e)}if(this.attr("myui-options")==null){return false}t=t||{};return this.each(function(){var e=$(this).attr("id");var a;var n=$.data(this,"datagrid");a=$.extend({},$.fn.datagrid2.defaults,$.fn.datagrid2.parseOptions(this),t);if(n){a=$.extend(n.options,t);n.options=a}else{if(!a.isAutoBuild){$.data(this,"datagrid",{options:a,panel:"",dc:"",data:{pager:[],datalist:[]}})}else{var i=packageGrid(this);if(!a.columns)a.columns=i.columns;if(!a.frozenColumns)a.frozenColumns=i.frozenColumns;if(!a.allColumns)a.allColumns=i.allColumns;a.columns=$.extend(true,[],a.columns);a.frozenColumns=$.extend(true,[],a.frozenColumns);a.allColumns=$.extend(true,[],a.allColumns);var r=$(this).find("thead[myui-options*='frozen:true']");var o=$(this).find("thead:not([myui-options*='frozen:true'])");if(r.length>0&&r.find("tr").length>1){a.multiForzenHeaderhtml=$(r).html()}if(o.length>0&&o.find("tr").length>1){a.multiHeaderhtml=$(o).html();if(r.find("tr").length!=o.find("tr").length){a.multiForzenHeaderhtml=null;a.multiHeaderhtml=null}}n=$.data(this,"datagrid",{options:a,panel:i.panel,dc:i.dc,data:{pager:[],datalist:[]}});var l=$.extend(a.queryParams,{page:1});buildGrid(this);showOptBtn(this);if(a.defaultQuery){request(this,l)}}}})};function packageGrid(t){var e=$('<div class="myui-datagrid2">'+'<div class="datagrid-header">'+'<div class="datagrid-title"></div>'+"</div>"+'<div class="datagrid-body">'+'<div class="datagrid-list">'+"</div>"+'<div class="datagrid-pager pagination">'+'<div class="pagination-info"></div>'+"</div>"+"</div>"+'<div class="datagrid-footer"></div>'+"</div>").insertAfter(t);var a=[];var n=[];var i=[];$(t).css("display","none");$(t).children("thead").each(function(){var t=[];var e=[];$(this).find("tr").each(function(){$(this).children().each(function(){var a=$.extend({},$.parser.parseOptions(this,["field","align","order","width","sortable","checkbox","hidden","datatype","autowidth","onClick","frozen","filter"]),{title:$(this).html()});if(a.field){i.push(a);if(a.datatype=="number"&&typeof a.align=="undefined"){a.align="right"}if(a.frozen==true){t.push(a)}else{e.push(a)}}})});a.push(t);n.push(e)});var r=e.children("div.datagrid-body").children("div.datagrid-list");var o=e.children("div.datagrid-body").children("div.datagrid-pager");return{panel:e,frozenColumns:a,columns:n,allColumns:i,dc:{pager:o,list:r}}}function bulidHeadByJson(t,e){$(t).empty();var a=e.cols;var n=e.opts;$(t).attr("myui-options","url:'"+n.url+"'");$(t).attr("width","1196px");$(t).attr("height","350px");if(n){if(n.width)$(t).attr("width",n.width);if(n.height)$(t).attr("height",n.height);if(n.frozenCnt)$(t).attr("myui-options",$(t).attr("myui-options")+",frozenCnt:'"+n.frozenCnt+"'");if(n.showColumn)$(t).attr("myui-options",$(t).attr("myui-options")+",showColumn:true");if(n.showFilters)$(t).attr("myui-options",$(t).attr("myui-options")+",showFilters:true");if(n.pagestyle)$(t).attr("myui-options",$(t).attr("myui-options")+",pagestyle:'"+n.pagestyle+"'");if(n.paramLineCnt)$(t).attr("myui-options",$(t).attr("myui-options")+",paramLineCnt:"+n.paramLineCnt);if(n.snapshot&&n.snapshot_queryid&&n.snapshot_url)$("#querylist").attr("myui-options",$("#querylist").attr("myui-options")+",snapshot:true, snapshot_queryid:'"+n.snapshot_queryid+"', snapshot_url:'"+n.snapshot_url+"'");if(n.showExport){$(t).attr("myui-options",$(t).attr("myui-options")+",exportUrl:'${ctx}/query_online!queryExport.action',exportFileName:'"+n.exportFileName+"'");if(n.selectMaxExportCnt&&n.selectMaxExportCnt>0){$(t).attr("myui-options",$(t).attr("myui-options")+",selectMaxExportCnt:'"+n.selectMaxExportCnt+"'")}if(n.exportpass&&n.exportpass!=""){$(t).attr("myui-options",$(t).attr("myui-options")+",exportpass:'"+n.exportpass+"'")}}if(n.pagesize){$(t).attr("myui-options",$(t).attr("myui-options")+",pagesize:"+n.pagesize)}}var i=new Object;var r=$("<thead></thead>").appendTo($(t));var o=$("<tr></tr>").appendTo($(r));for(var l=0;l<a.length;l++){var s=a[l];var d=s.dsid;if(i[d]){i[d]=i[d]+","+s.colname+"@@@"+s.colname_ognl}else{i[d]=s.colname+"@@@"+s.colname_ognl}var u="";if(s.datatype){u=",datatype:'"+s.datatype+"'"}var c=",width:'150'";if(s.width&&s.autowidth==false){c=",width:'"+s.width+"'"}var p=",autowidth:true";if(s.autowidth==false){p=",autowidth:false"}var f="";if(s.dataformat){f=",dataformat:'"+s.dataformat+"'"}var m="";if(s.align){m=",align:'"+s.align+"'"}$(o).append("<th myui-options=\"field:'"+s.colname+"',sortable:true"+c+m+u+p+f+'">'+s.coldesc+"</th>")}}function indexOfArray(t,e){for(var a=0,n=t.length;a<n;a++){if(t[a]==e)return a}return-1}function buildGrid(t){var e=$(t).datagrid2("data");var a=e.options;var n=e.dc;var i=e.panel;createColumnHeader(t,n.list,a.allColumns,a.multiHeaderhtml);var r=$(t).attr("width");var o=$(t).attr("height");r=r==null?a.defaultLength+"px":r;var l=i.children("div.datagrid-body");var s=l.children("div.datagrid-list");$(l).css("width",r);$(l).children("div.datagrid-pager").css("width",r.replace("px","").replace("PX","")-4);$(s).css("width",r).css("height",o);setLabel(t)}function createColumnHeader(t,e,a,n){if(!a)return;$(e).empty();var i=parseInt(Math.random()*1e6);var r=$('<table cellspadding="0" id="datagrid'+i+'" cellspacing="0"><tbody></tbody></table>').appendTo($(e));var o=$('<tr class="header-row"></tr>').appendTo($("tbody",r));for(var l=0;l<a.length;l++){var s=a[l];if(s.hidden!=true&&s.field){var d=$("<td></td>").appendTo(o);if(s.checkbox){d.addClass("list-cell-widgets-td");d.attr("field",s.field);$('<div class="list-cell-widgets"></div>').html('<input type="checkbox" name="checkboxitem"/>').appendTo(d);$(d).find('input[name="checkboxitem"]').click(function(){if($(this).attr("checked")){$(t).datagrid2("checkAll")}else{$(t).datagrid2("unCheckAll")}})}else if(s.field){d.attr("field",s.field);d.append('<div class="list-cell"></div>');if(s.autowidth!=true&&s.width){$(d).find("div.list-cell").width(s.width)}$("div",d).html(s.title)}}}createHeaderSort(t)}function createHeaderSort(t){var e=$(t).datagrid2("data");var a=e.options;var n=e.dc;var i=e.panel;for(var r=0;r<a.allColumns.length;r++){var o=a.allColumns[r];if(o.sortable&&!o.checkbox){var l=getColumnTdByName(t,o.field);$(l).children(".list-cell").children(".datagrid-sort-icon").remove();$(l).children(".list-cell").append('<span class="datagrid-sort-icon">&nbsp;</span>');$(l).find(".datagrid-sort-icon").addClass("myui-common-hover");$(l).find(".datagrid-sort-icon").click(function(){var e=getColumnByName($(t),$(this).parent().parent().attr("field"));sortGrid($(t),e)})}}}function setLabel(t){$(t).find("th").each(function(){var t=$.parser.parseOptions($(this),["field","checkbox","queryParams","sortable"]);if(t.field!=null&&$(this).html!=""){$(this).wrapInner("<label/>")}})}function setLoadedStyle(t){var e=$(t).datagrid2("data");var a=e.dc;var n=e.options;var i=n.frozenColumns;var r=n.columns;var o=e.panel;var l=$(o).children("div.datagrid-body");var s=$(l).children("div.datagrid-list");$(s).find("table").each(function(){$(this).find(".data-row").addClass("myui-datagrid-tr-odd");$(this).find(".data-row:odd").addClass("myui-datagrid-tr-even")});$(s).find(".data-row").hover(function(){$(s).find(".data-row[idx='"+$(this).attr("idx")+"']").addClass("tr_hover")},function(){$(s).find(".data-row[idx='"+$(this).attr("idx")+"']").removeClass("tr_hover")});updateSortStyle(t)}function request(t,e){var a=$(t).datagrid2("data");var n=a.options;if(e)n.queryParams=e;var i=$.extend({},n.queryParams);if(n.showColumnList){$.extend(i,{showColumnList:n.showColumnList});if(n.custColExpr){$.extend(i,{custColExpr:n.custColExpr})}if(n.mergeColumnList){$.extend(i,{mergeColumnList:n.mergeColumnList})}$(t).datagrid2("setColumnHide",n.showColumnList)}if(n.filterColumnList){$(t).datagrid2("updateFilterColumn");$.extend(i,{filterColumnList:n.filterColumnList})}if(n.paramColumnList){$.extend(i,{paramColumnList:n.paramColumnList})}if(n.pagesize){$.extend(i,{rows:n.pagesize})}updateSortStyle(t);if(n.sort){$.extend(i,{sort:n.sort,order:n.order})}if(n.onBeforeLoad.call(t,i)==false)return;$(t).datagrid2("loading");var r=n.loader.call(t,i,function(e){$(t).datagrid2("loadData",e);if(n.pagination){$(t).datagrid2("loadPager",e.pager)}$(t).datagrid2("loaded")},function(){$(t).datagrid2("loaded");n.onLoadError.apply(t,arguments)});if(r==false){$(t).datagrid2("loaded")}}function getColumnByName(t,e){var a=$(t).datagrid2("data");var n=a.options;var i;for(var r=0;r<n.allColumns.length;r++){if(n.allColumns[r].field==e)i=n.allColumns[r]}return i}function setColumnAttr(t,e){var a=$(t).datagrid2("data");var n=a.options;if(e&&e.col&&e.attr&&e.attr.length>0){for(var i=0;i<n.allColumns.length;i++){for(var r=0;r<e.attr.length;r++){var o=n.allColumns[i];if(n.allColumns[i].field==e.col){o[e.attr[r].name]=e.attr[r].value}}}}}function getColumnTdByName(t,e){var a=$(t).datagrid2("data");var n=a.dc;var i=$(n.list).find(".header-row").children('[field="'+e+'"]');return i}function sortGrid(t,e){var a=$(t).datagrid2("options");var n={sort:a.sort,order:a.order};var i=[];var r=[];if(n.sort){i=n.sort.split(",");r=n.order.split(",")}var o=e;if(!o.sortable){return}var l=o.order||"asc";var s=indexOfArray(i,o.field);if(s>=0){var d=r[s]=="asc"?"desc":"asc";if(a.multiSort&&d==l){i.splice(s,1);r.splice(s,1)}else{r[s]=d}}else{if(a.multiSort){i.push(o.field);r.push(l)}else{i=[o.field];r=[l]}}n.sort=i.join(",");n.order=r.join(",");$.extend(a,n);if(a.remoteSort){request(t)}else{var u=$(t).datagrid2("getData");$(t).datagrid2("loadData",u)}}function showOptBtn(t){initShowParamOperateBtn(t);initShowColumn(t);initShowFilters(t);initExpBtn(t);initEditStyleBtn(t);initMultiHeaderBtn(t);initSelPager(t);initSnapshotBtn(t)}function initShowColumn(t){var e=$(t).datagrid2("options");if(e.showColumn){var a=$('<a class="tableop-showcolumn" href="javascript:void(0);">选择列</a>');$(a).bind("click",function(){setShowColumnWin(t)});$(t).datagrid2("appendTableOperate",$(a));$("body").append('<div id="showColumnWin"></div>')}}function initSnapshotBtn(t){var e=$(t).datagrid2("options");var a=$('<a href="javascript:void(0);">快照</a>');var n=window.document.location.pathname;var i=n.substring(0,n.substr(1).indexOf("/")+1);if(e.snapshot){$(a).bind("click",function(){if(e.snapshot_queryid==null||typeof e.snapshot_queryid=="undefined"){$.messager.alert('<s:text name="common_msg_info"/>',"快照配置有误，未配置<br>snapshot_queryid属性","error");return false}if(e.snapshot_url==null||typeof e.snapshot_url=="undefined"){$.messager.alert('<s:text name="common_msg_info"/>',"快照配置有误，未配置<br>snapshot_url属性","error");return false}$("#showSnapshotWin").window({open:true,headline:"快照（点击红色按钮可保存当前查询快照）",param:{queryid:e.snapshot_queryid,url:e.snapshot_url},content:'<iframe id="myframe" src="'+i+'/mybi/pim/snapshot/pim-snapshot.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:550,panelHeight:370})});$(".myui-datagrid2").datagrid2("appendTableOperate",$(a));$("body").append('<div id="showSnapshotWin"></div>')}}function initSelPager(t){var e=$(t).datagrid2("options");if(e.showSelPager){var a=$('<a href="javascript:void(0);">分页选择<span class="myui-icon-down">&nbsp;</span></a>');$(t).datagrid2("appendTableOperate",$(a));$(a).parent().append("<div class='datagrid-export-seltype' style='display: none;'><table></table></div>");if(e.defaultSelPager){var n=e.defaultSelPager.split(",");for(var i=0;i<n.length;i++){$(a).parent().find(".datagrid-export-seltype table").append('<tr><td value="'+n[i]+'">'+n[i]+"条</td></tr>")}}$(a).parent().click(function(t){$(this).find(".datagrid-export-seltype").css("top",$(this).position().top+23);$(this).find(".datagrid-export-seltype").css("left",$(this).position().left);$(this).find(".datagrid-export-seltype").show()}).mouseleave(function(t){$(this).find(".datagrid-export-seltype").hide()});$(a).parent().find(".datagrid-export-seltype td").bind("click",function(){var e=$(t).datagrid2("options");if(e.queryParams){e.queryParams.pageSize=$(this).attr("value");e.queryParams.page=1}$(this).parent().parent().parent().parent().parent().children("a").html($(this).attr("value")+'条/页<span class="myui-icon-down">&nbsp;</span>');request($(t),e.queryParams)})}}function setShowColumnWin(t){var e=window.document.location.pathname;var a=e.substring(0,e.substr(1).indexOf("/")+1);$("#showColumnWin").window({open:true,headline:"选择列",param:$(t),content:'<iframe id="myframe" src="'+a+'/mybi/common/components/myui_datagrid/datagrid-showcolumn.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:590,panelHeight:460})}function initShowFilters(t){var e=$(t).datagrid2("options");if(e.showFilters){var a=$('<a href="javascript:void(0);">列筛选</a>');$(a).bind("click",function(){setShowFiltersWin(t)});$(t).datagrid2("appendTableOperate",$(a));$("body").append('<div id="showFiltersWin"></div>')}}function setShowFiltersWin(t){var e=window.document.location.pathname;var a=e.substring(0,e.substr(1).indexOf("/")+1);$("#showFiltersWin").window({open:true,headline:"列筛选",param:$(t),content:'<iframe id="myframe" src="'+a+'/mybi/common/components/myui_datagrid/datagrid-showfilters.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:680,panelHeight:400})}function initExpBtn(t){var e=$(t).datagrid2("data");var a=e.options;var n=window.document.location.pathname;var i=n.substring(0,n.substr(1).indexOf("/")+1);if(a.exportUrl){var r=$('<a href="javascript:void(0);">导出<span class="myui-icon-down">&nbsp;</span></a>');$(t).datagrid2("appendTableOperate",$(r));$("body").append('<div id="dataExport"></div>');$(r).parent().append("<div class='datagrid-export-seltype' style='display: none;'><table><tr><td type='xlsx'>Excel</td></tr><tr><td type='csv'>CSV</td></tr><tr><td type='txt'>TXT</td></tr></table></div>");
$(r).parent().click(function(t){$(this).find(".datagrid-export-seltype").css("top",$(this).position().top+23);$(this).find(".datagrid-export-seltype").css("left",$(this).position().left-24);$(this).find(".datagrid-export-seltype").show()}).mouseleave(function(t){$(this).find(".datagrid-export-seltype").hide()});$(r).parent().find(".datagrid-export-seltype td").bind("click",function(){var n=a.exportUrl.split("!")[0];var r=(new Date).getTime()+parseInt(1e4*Math.random());var o=$(e.dc.pager).html();var l=$.extend({},a.queryParams,{showColumnList:a.showColumnList,mergeColumnList:a.mergeColumnList,filterColumnList:a.filterColumnList,paramColumnList:a.paramColumnList,custColExpr:a.custColExpr,sort:a.sort,order:a.order,exportColumnList:JSON.stringify($(t).datagrid2("getVisableColumn2Json")),exportFileName:a.exportFileName,exportFileType:$(this).attr("type"),datagridExportParamKey:r,totalRecord:e.data.pager.totalRecord});if(a.exportpass&&a.exportpass!=""){$.messager.confirm2('<s:text name="common_msg_info"/>',"密码：<input class='myui-text' id='myui-datagrid-exppsd' style='width:120px' type='text'>",function(t,o){if($(o).find("#myui-datagrid-exppsd").val()!=a.exportpass){$.messager.alert('<s:text name="common_msg_error"/>',"密码输入错误","error");return false}if(a.selectMaxExportCnt&&a.selectMaxExportCnt<e.data.pager.totalRecord){var s={param:l,url_action:n,exportUrl:a.exportUrl,randomkey:r,selectMaxExportCnt:a.selectMaxExportCnt,queryParams:a.queryParams};$("#dataExport").window({open:true,headline:"数据导出",param:s,content:'<iframe id="myframe" src="'+i+'/mybi/common/components/myui_datagrid/datagrid-selectMaxExportCnt.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:550,panelHeight:250})}else{$.post(n+"!setDatagridExportParam.action",l,function(t){monitorExportStatus(n+"!monitorExportStatus.action");window.location.href=encodeURI(a.exportUrl+"?datagridExportParamKey="+r+json2UrlParam(a.queryParams))})}})}else{if(a.selectMaxExportCnt&&a.selectMaxExportCnt<e.data.pager.totalRecord){var s={param:l,url_action:n,exportUrl:a.exportUrl,randomkey:r,selectMaxExportCnt:a.selectMaxExportCnt,queryParams:a.queryParams};$("#dataExport").window({open:true,headline:"数据导出",param:s,content:'<iframe id="myframe" src="'+i+'/mybi/common/components/myui_datagrid/datagrid-selectMaxExportCnt.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:550,panelHeight:250})}else{$.post(n+"!setDatagridExportParam.action",l,function(t){monitorExportStatus(n+"!monitorExportStatus.action");window.location.href=encodeURI(a.exportUrl+"?datagridExportParamKey="+r+json2UrlParam(a.queryParams))})}}})}}function initShowParamOperateBtn(t){var e=$(t).datagrid2("options");if(e.showParamOperate){var a=$('<a href="javascript:void(0);">条件定制</a>');$(a).bind("click",function(){setShowParamOperateWin(t)});$(t).datagrid2("appendTableOperate",$(a));$("body").append('<div id="showParamOperateWin"></div>')}}function setShowParamOperateWin(t){var e=window.document.location.pathname;var a=e.substring(0,e.substr(1).indexOf("/")+1);$("#showParamOperateWin").window({open:true,headline:"条件定制",param:$(t),content:'<iframe id="myframe" src="'+a+'/mybi/common/components/myui_datagrid/datagrid-showParamOperate.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:750,panelHeight:450})}function initEditStyleBtn(t){var e=$(t).datagrid2("options");if(e.showEditStyle){var a=$('<a href="javascript:void(0);">编辑样式</a>');$(a).bind("click",function(){setShowEditStyleWin(t)});$(t).datagrid2("appendTableOperate",$(a));$("body").append('<div id="showEditStyleWin"></div>')}}function setShowEditStyleWin(t){var e=window.document.location.pathname;var a=e.substring(0,e.substr(1).indexOf("/")+1);$("#showEditStyleWin").window({open:true,headline:"编辑样式",param:$(t),content:'<iframe id="myframe" src="'+a+'/mybi/common/components/myui_datagrid/datagrid-showEditStyle.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:820,top:5,panelHeight:500})}function initMultiHeaderBtn(t){var e=$(t).datagrid2("options");if(e.showEditStyle){var a=$('<a href="javascript:void(0);">多表头设置</a>');$(a).bind("click",function(){initMultiHeaderWin(t)});$(t).datagrid2("appendTableOperate",$(a));$("body").append('<div id="showMultiHeaderWin"></div>')}}function initMultiHeaderWin(t){var e=window.document.location.pathname;var a=e.substring(0,e.substr(1).indexOf("/")+1);$("#showMultiHeaderWin").window({open:true,headline:"多表头设置",param:$(t),content:'<iframe id="myframe" src="'+a+'/mybi/common/components/myui_datagrid/datagrid-editmultiheader.jsp" scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:650,panelHeight:400})}function updateSortStyle(t){var e=$(t).datagrid2("data");var a=e.options;var n=e.dc;$(n.list).find("table div.list-cell").removeClass("datagrid-sort-asc datagrid-sort-desc");$(n.list).find("table div.list-cell").removeClass("datagrid-sort-asc datagrid-sort-desc");if(a.sort){var i=a.sort.split(",");var r=a.order.split(",");for(var o=0;o<i.length;o++){var l=getColumnTdByName(t,i[o]);$(l).children("div.list-cell").addClass("datagrid-sort-"+r[o])}}}function initFormatBtn(t){var e=$(t).datagrid2("options");if(e.showFormat){var a=$('<a href="javascript:void(0);">选择格式</a>');$(a).bind("click",function(){alert(JSON.stringify(e.allColumns));setShowFiltersWin(t)});$(t).datagrid2("appendTableOperate",$(a));$("body").append('<div id="showFormatWin"></div>')}}function loadPager_style1(jq,pager){var dgdata=$(jq).datagrid2("data");var opts=dgdata.options;var pagerArea=$(dgdata.dc.pager).children("div.pagination-info");var currentPage=pager.currentPage;var totalRecord=pager.totalRecord;var totalPage=pager.totalPage;var queryFun="";var nexPage=currentPage+1;var prePage=currentPage-1;var pageInfo=$("<div></div>");var pageInfoUl=$("<ul></ul>").appendTo($(pageInfo));if(totalRecord==0){pageInfoUl.append("<li><span>无查询结果</span></li>")}else{pageInfoUl.append('<li><span class="prepage">&lt;&lt; 上一页</span></li>');if(totalPage<=7){for(var i=1;i<=totalPage;i++){pageInfoUl.append('<li><span class="pagenum" id="pagenum'+i+'">'+i+"</span></li>")}}else{if(currentPage<=5){for(var i=1;i<=7;i++){pageInfoUl.append('<li><span class="pagenum" id="pagenum'+i+'">'+i+"</span></li>")}pageInfoUl.append('<li><span class="pagemore">...</span></li>')}else{pageInfoUl.append('<li><span class="pagenum" id="pagenum'+1+'">'+1+"</span></li>");pageInfoUl.append('<li><span class="pagenum" id="pagenum'+2+'">'+2+"</span></li>");pageInfoUl.append('<li><span class="pagemore">...</span></li>');if(currentPage>=totalPage-2){for(var i=4;i>=0;i--){var v_pncnt=totalPage-i;pageInfoUl.append('<li><span class="pagenum" id="pagenum'+v_pncnt+'">'+v_pncnt+"</span></li>")}}else{for(var i=-2;i<=2;i++){var v_pncnt=currentPage+i;pageInfoUl.append('<li><span class="pagenum" id="pagenum'+v_pncnt+'">'+v_pncnt+"</span></li>")}pageInfoUl.append('<li><span class="pagemore">...</span></li>')}}}pageInfoUl.append('<li><span class="nextpage">下一页  &gt;&gt;</span></li>');pageInfoUl.append('<li><span class="totalpage" value="'+totalPage+'">共'+totalPage+"页</span></li>");pageInfoUl.append('<li><span class="topage">到第 <input class="topagenum"/> 页</span></li>');pageInfoUl.append('<li><span class="topagebtn">确 定</span></li>');$(pageInfoUl).find("#pagenum"+currentPage).attr("class","pagenumsel");$(pageInfoUl).find(".pagenum").click(function(){$(jq).datagrid2("loadPageData",$(this).html())});if(currentPage==1){$(pageInfoUl).find(".prepage").attr("class","prepagenolink")}else{$(pageInfoUl).find(".prepage").click(function(){$(jq).datagrid2("loadPageData",prePage)})}if(currentPage==totalPage){$(pageInfoUl).find(".nextpage").attr("class","nextpagenolink")}else{$(pageInfoUl).find(".nextpage").click(function(){$(jq).datagrid2("loadPageData",nexPage)})}$(pageInfoUl).find(".topagenum").val(currentPage);$(pageInfoUl).find(".topagebtn").click(function(){var v_topagenum=$(this).parent().parent().find(".topagenum").val();var v_totalpage=$(this).parent().parent().find(".totalpage").attr("value");if($.isNumeric(v_topagenum)){if(eval(v_topagenum)<=1){v_topagenum=1}else if(eval(v_topagenum)>=eval(v_totalpage)){v_topagenum=v_totalpage}}else{v_topagenum=1}$(jq).datagrid2("loadPageData",v_topagenum)})}pagerArea.empty();pagerArea.html($(pageInfo))}function loadPager_default(t,e){var a=$(t).datagrid2("data");var n=$(a.dc.pager).children("div.pagination-info");var i=e.currentPage;var r=e.totalRecord;var o=e.totalPage;var l=e.pageSize;var s="";var d=i+1;var u=i-1;var c=$("<div></div>");if(e.totalRecord==0){$(c).append("共"+r+"条&nbsp; ");$(c).append("首页&nbsp;");$(c).append("上一页&nbsp;");$(c).append("下一页&nbsp;");$(c).append("末页&nbsp;");$(c).append("第0/0页")}else if(o==1){fromNum=1;toNum=r;$(c).append("共"+r+"条&nbsp;");$(c).append("首页&nbsp;");$(c).append("上一页&nbsp;");$(c).append("下一页&nbsp;");$(c).append("末页&nbsp;");$(c).append("第"+i+"/"+o+"页")}else if(i==o){fromNum=(i-1)*l+1;toNum=r;$(c).append("共"+r+"条&nbsp;");var p=$("<a href='###'>首页</a>&nbsp;").appendTo($(c));$(c).append("&nbsp;");$(p).click(function(){$(t).datagrid2("loadPageData",1)});var f=$("<a href='###'>上一页</a>&nbsp;").appendTo($(c));$(f).click(function(){$(t).datagrid2("loadPageData",u)});$(c).append("&nbsp;");$(c).append("下一页&nbsp;");$(c).append("末页&nbsp;");$(c).append("第"+i+"/"+o+"页")}else if(i<=1){fromNum=1;toNum=l;$(c).append("共"+r+"条&nbsp;");$(c).append("首页&nbsp;");$(c).append("上一页&nbsp;");var m=$("<a href='###'>下一页</a>&nbsp;").appendTo($(c));$(m).click(function(){$(t).datagrid2("loadPageData",d)});$(c).append("&nbsp;");var h=$("<a href='###'>末页</a>&nbsp;").appendTo($(c));$(h).click(function(){$(t).datagrid2("loadPageData",o)});$(c).append("&nbsp;");$(c).append("第"+i+"/"+o+"页")}else{fromNum=(i-1)*l+1;toNum=i*l;$(c).append("共"+r+"条&nbsp;");var p=$("<a href='###'>首页</a> ").appendTo($(c));$(p).click(function(){$(t).datagrid2("loadPageData",1)});$(c).append("&nbsp;");var f=$("<a href='###'>上一页</a> ").appendTo($(c));$(f).click(function(){$(t).datagrid2("loadPageData",u)});$(c).append("&nbsp;");var m=$("<a href='###'>下一页</a> ").appendTo($(c));$(m).click(function(){$(t).datagrid2("loadPageData",d)});$(c).append("&nbsp;");var h=$("<a href='###'>末页</a> ").appendTo($(c));$(h).click(function(){$(t).datagrid2("loadPageData",o)});$(c).append("&nbsp;");$(c).append("第"+i+"/"+o+"页")}$(c).find("a").addClass("linkStyle");n.empty();n.html($(c))}function freezeTable(t,e,a,n,i){if(typeof e=="string")e=parseInt(e);if(typeof a=="string")a=parseInt(a);var r;if(typeof t=="string"){r=t;t=$("#"+r)}else r=t.attr("id");var o=$("#"+r+"_tableLayout");if(o.length!=0){o.before(t);o.empty()}else{t.after("<div id='"+r+"_tableLayout' class='datagrid_list_tableLayout' style='margin:0px auto;position:relative;top:0px;overflow:hidden;height:"+i+"px; width:"+n+"px;'></div>");o=$("#"+r+"_tableLayout")}var l="";if(e>0&&a>0)l+='<div id="'+r+'_tableFix" style="padding: 0px;"></div>';if(e>0)l+='<div id="'+r+'_tableHead" style="padding: 0px;"></div>';if(a>0)l+='<div id="'+r+'_tableColumn" style="padding: 0px;"></div>';l+='<div id="'+r+'_tableData"  class="datagrid_list_tableData" style="padding: 0px;"></div>';$(l).appendTo("#"+r+"_tableLayout");var s=e>0&&a>0?$("#"+r+"_tableFix"):null;var d=e>0?$("#"+r+"_tableHead"):null;var u=a>0?$("#"+r+"_tableColumn"):null;var c=$("#"+r+"_tableData");c.append(t);if(s!=null){var p=t.clone(true);p.attr("id",r+"_tableFixClone");s.append(p)}if(d!=null){var f=t.clone(true);f.attr("id",r+"_tableHeadClone");d.append(f)}if(u!=null){var m=t.clone(true);m.attr("id",r+"_tableColumnClone");u.append(m)}$("#"+r+"_tableLayout table").css("margin","0");if(e>0){var h=0;var v=0;$("#"+r+"_tableHead tr:lt("+e+")").each(function(){if(v>0)v--;else{var t=$(this).find("td:first, th:first");h+=t.outerHeight(true);v=t.attr("rowSpan");if(typeof v=="undefined")v=0;else v=parseInt(v)-1}});h+=2;d.css("height",h);s!=null&&s.css("height",h)}if(a>0){var g=0;var y=0;$("#"+r+"_tableColumn tr:eq("+e+")").find("td:lt("+a+"), th:lt("+a+")").each(function(){if(y>=a)return;g+=$(this).outerWidth(true);y+=$(this).attr("colSpan")?parseInt($(this).attr("colSpan")):1});g+=2;u.css("width",g);s!=null&&s.css("width",g)}c.scroll(function(){d!=null&&d.scrollLeft(c.scrollLeft());u!=null&&u.scrollTop(c.scrollTop())});s!=null&&s.css({overflow:"hidden",position:"absolute","z-index":"50"});d!=null&&d.css({overflow:"hidden",width:n-17,position:"absolute","z-index":"45"});u!=null&&u.css({overflow:"hidden",height:i-17,position:"absolute","z-index":"40"});c.css({overflow:"auto",width:n,height:i,position:"absolute"});s!=null&&s.offset(o.offset());d!=null&&d.offset(o.offset());u!=null&&u.offset(o.offset());c.offset(o.offset())}function getCheckedRows(t){}function getSelectedRows(t){}function checkRow(t,e,a){}function uncheckRow(t,e,a){}function selectRow(t,e,a){}function unselectRow(t,e,a){}function selectRow(t,e,a){}function unselectRow(t,e,a){}function selectAll(t,e){}function unselectAll(t,e){}$.fn.datagrid2.methods={options:function(t){return $.data($(t)[0],"datagrid").options},data:function(t){return $.data($(t)[0],"datagrid")},cache:function(t,e){return $.data($(t)[0],"datagrid",e)},appendTableOperate:function(t,e){var a=$(t).datagrid2("data");var n=a.panel;var i=n.children(".datagrid-header");var r=n.children(".datagrid-body");var o="";if($(t).prev().attr("class")=="myui-template-operating"){if($(t).prev().children(".tableop").length>0){o=$("<li></li>").appendTo($(t).prev().children(".tableop").children("ul"))}else{var l=$('<div class="tableop"></div>').appendTo($(t).prev());var s=$("<ul></ul>").appendTo($(l));o=$("<li></li>").appendTo($(t).prev().children(".tableop").children("ul"))}}else{if($(i).children(".tableop").length>0){o=$("<li></li>").prependTo($(i).children("div.tableop").children("ul"))}else{var l=$('<div class="tableop"></div>').appendTo($(i));var s=$("<ul></ul>").appendTo($(l));o=$("<li></li>").appendTo($(s))}$(i).css("width",$(r).css("width"))}o.append($(e))},loaded:function(t){return t.each(function(){var e=$(t).datagrid2("data");var a=e.panel;$(a).children(".myui-template-onloadlayer").remove();setLoadedStyle(t)})},reloadData:function(t,e){if(e==true){var a=$(t).datagrid2("data");var n=a.options;$.extend(n.queryParams,{page:1});request(t)}else{var i=$(t).datagrid2("getData");$(t).datagrid2("loadData",i);$(t).datagrid2("loaded")}},load:function(t,e){var a=$(t).datagrid2("options");var n=JSON.parse(a.paramColumnList);var i=false;$(n).each(function(t){var e=$(this)[0];e.value=$("#"+e.id).val();if(e.partyp=="sql"&&e.value==""){$.messager.alert('<s:text name="common_msg_info"/>',"查询条件  “ "+e.desc+"” 为必输项，请输入后查询","info");i=true;return false}if(e.type=="select"){e.value=$("#"+e.id).combo("getValue")==null?"":$("#"+e.id).combo("getValue")}else if(e.type=="popradio"||e.type=="popcheckbox"){e.value=$("#"+e.id).popselector("getValue")==null?"":$("#"+e.id).popselector("getValue")}else if(e.type=="multinput"){e.value=($("#"+e.id).multinput2("getValue")==null?"":$("#"+e.id).multinput2("getValue")).join(",")}});if(i){return false}if(n){a.paramColumnList=JSON.stringify(n)}if(a.queryParams.pageSize){e.pageSize=a.queryParams.pageSize}request(t,e)},loadPager:function(t,e){var a=$(t).datagrid2("options");if(a.pagestyle&&a.pagestyle=="hide"){return false}else if(a.pagestyle&&a.pagestyle=="style1"){loadPager_style1(t,e)}else{loadPager_default(t,e)}},loadPageData:function(t,e){var a=$(t).datagrid2("options");var n=$.extend(a.queryParams,{page:e});request(t,n)},reLoadPanelStyle:function(t){buildGrid(t)},loadData:function(jq,data){var dgdata=$(jq).datagrid2("data");var dc=dgdata.dc;var opts=dgdata.options;var frozenColumns=opts.frozenColumns;var columns=opts.columns;var pathName=window.document.location.pathname;var projectName=pathName.substring(0,pathName.substr(1).indexOf("/")+1);var hasSyncDataLoad=false;$.extend(dgdata,{data:data});var cols=opts.allColumns;if($(dc.list).children("table").length!=1){createColumnHeader(jq,dc.list,opts.allColumns)}$(dc.list).find(".data-row").remove();if(data&&data.datalist.length>0){$.each(data.datalist,function(idx,ds){var tr=$("<tr class='data-row' idx='"+idx+"'></tr>").appendTo($(dc.list).find("table"));for(var j=0;j<cols.length;j++){if(cols[j].hidden){continue}var val=ds[cols[j].field]?ds[cols[j].field]:"";if(cols[j].datatype=="date"&&val&&val!=""){var v_date=new Date(val.time);val=1900+v_date.getYear()+"-"+(v_date.getMonth()+1)+"-"+v_date.getDate()}else if(cols[j].datatype=="number"&&(!val||val=="")){val=0}if(cols[j].checkbox){var v_chtd=$('<td class="list-cell-widgets-td"><div class="list-cell-widgets"><input type="checkbox" name="checkboxitem" value="'+val+'"/></div></td>').appendTo(tr);$(v_chtd).find("input").click(function(){$(jq).datagrid2("clickCheck",$(this).parent().parent().parent().attr("idx"))})}else{if(cols[j].dataformat&&cols[j].dataformat!=""){if(cols[j].dataformat=="num-ths"){val=formatNum2Thousand(val)}}var vt_td=$('<td  field="'+cols[j].field+'"><div class="list-cell">'+val+"</div></td>").appendTo(tr);if(cols[j].align&&cols[j].align!="left"){$(vt_td).attr("align",cols[j].align)}if(cols[j].autowidth!=true&&cols[j].width){$(vt_td).find("div.list-cell").width(cols[j].width)}if(cols[j].onClick){var v_isonClick=true;if(cols[j].filter&&cols[j].filter.onClick){if($.inArray(val,cols[j].filter.onClick.split(","))==-1){v_isonClick=false}}if(!v_isonClick){continue}$(vt_td).find(".list-cell").addClass("linkStyle");$(vt_td).find(".list-cell").attr("onClickStr",cols[j].onClick);$(vt_td).find(".list-cell").click(function(){var v_rowobj=JSON.stringify($(jq).datagrid2("getRowDataByIdx",$(this).parent().parent().attr("idx")));eval($(this).attr("onClickStr")+".call("+$(this).attr("onClickStr")+","+v_rowobj+");")})}if(cols[j].link){var v_paramarr=[];v_paramarr.push("?islink=true&id="+cols[j].link.query);if($(jq).attr("edit")=="true"){v_paramarr.push("edit=true")}for(var k=0;k<cols[j].link.params.length;k++){var v_linkparobj=cols[j].link.params[k];v_paramarr.push(v_linkparobj.name+"="+ds[v_linkparobj.col])}var v_queryaction="query_online!query.action";if(window.location.href.indexOf("query_online!queryfun.action")>=0){v_queryaction="query_online!queryfun.action"}$(vt_td).find(".list-cell").attr("link",projectName+"/"+v_queryaction+v_paramarr.join("&"));$(vt_td).find(".list-cell").addClass("linkStyle");$(vt_td).find(".list-cell").click(function(){window.location.href=$(this).attr("link");var t=parent.$("body").data("linkhis");if(typeof t=="undefined"){t=[]}else{t=$(t).toArray()}t.push({querycase:$(jq).datagrid2("getCase"),queryid:$(jq).attr("queryid"),edit:$(jq).attr("edit"),queryname:$(jq).attr("queryname")+"("+$(this).html()+")"});parent.$("body").data("linkhis",t)})}}}})}if(data.datalist.length*30+25+1<$(jq).height()){var v_scollhei=0;if($(dc.list).width()<$(dc.list).find("table").width()){v_scollhei=20}$(dc.list).height(data.datalist.length*30+25+1+v_scollhei)}else{$(dc.list).height($(jq).height())}freezeTable($(dc.list).find("table").attr("id"),$(dc.list).find("table .header-row").length||0,opts.frozenColumns[0].length||0,$(dc.list).width(),$(dc.list).height())},getData:function(t){return $.data($(t)[0],"datagrid").data},loading:function(t){var e=$(t).datagrid2("data");var a=e.panel;$(a).append('<div class="myui-template-onloadlayer"><div class="myui-template-onloadlayer-mod"></div><div class="myui-template-onloadlayer-img"></div></div>');$(a).children(".myui-template-onloadlayer").show()},sort:function(t,e){return t.each(function(){sortGrid(this,e)})},deleteCustColumnByField:function(t,e){var a=$(t).datagrid2("data");var n=a.options;var i=false;for(var r=0;r<n.allColumns.length;r++){if(n.allColumns[r].field==e){n.allColumns.splice(r,1)}}for(var r=0;r<n.columns.length;r++){var o=n.columns[r];for(var l=0;l<o.length;l++){if(o[l].field==e){o.splice(l,1)}}}},initCustColumn:function(t,e){if(e){var a=$(t).datagrid2("data");var n=a.options;var i=JSON.parse(e);for(var r=0;r<i.length;r++){var o=i[r];n.allColumns.push(o);for(var l=0;l<n.columns.length;l++){var s=n.columns[l];s.push(o)}}}},saveOrUpdateCustColumn:function(t,e){var a=$(t).datagrid2("data");var n=a.options;var i=false;for(var r=0;r<n.allColumns.length;r++){if(n.allColumns[r].field==e.field){i=true;n.allColumns[r]=e}}if(i){for(var r=0;r<n.columns.length;r++){var o=n.columns[r];for(var l=0;l<o.length;l++){if(o[l].field==e.field){o[l]=e}}}}else{n.allColumns.push(e);for(var r=0;r<n.columns.length;r++){var o=n.columns[r];o.push(e)}}},operateColumn:function(t,e){var a=$(t).datagrid2("data");var n=a.options;var i=a.dc;var r=a.panel;var o=n.showColumnList;var l=n.mergeColumnList;var s=n.custColExpr;var d="";if(e){o=e.split("###")[0];l=e.split("###")[1];frozenCnt=e.split("###")[2];s=e.split("###")[3];all_cols=e.split("###")[4];v_colDatastyles=e.split("###")[5];var u=0;if(n.sort){var c=n.sort.split(",");var p=n.order.split(",");var f=n.order.split(",");for(var m=0;m<c.length;m++){var h=c[m];if((","+o).indexOf(","+h+",")<0){c.splice(m,1);p.splice(m,1);u++}}n.sort=c.join(",");n.order=p.join(",")}var v=true;if((!n.mergeColumnList&&!l||n.mergeColumnList==l)&&u==0&&(!n.custColExpr&&!s||n.custColExpr==s)){v=false}n.showColumnList=o;n.mergeColumnList=l;n.frozenCnt=frozenCnt;n.custColExpr=s;n.allColumnSortList=all_cols;n.colDatastyles=v_colDatastyles;$(t).datagrid2("setColumnHide",o);$(t).datagrid2("setColDatastyles");$(t).datagrid2("sortAndFrozenColumn");$(t).datagrid2("reLoadPanelStyle");var g=$(t).datagrid2("getData");if(g.datalist.length>0){for(var m=0;m<n.allColumns.length;m++){if(!g.datalist[0][n.allColumns[m].field]){v=true;break}}}$(t).datagrid2("reloadData",v)}},setColDatastyles:function(t){var e=$(t).datagrid2("data");var a=e.options;if(a.colDatastyles){var n=JSON.parse(a.colDatastyles);for(var i=0;i<a.allColumns.length;i++){delete a.allColumns[i].link}var r=[];for(var o=0;o<n.length;o++){setColumnAttr(t,{col:n[o].col,attr:[{name:"link",value:n[o].link}]})}}},operateMultiHeaderColumn:function(t,e){if(e){opts.multiHeaderhtml="";if(e.frheader){var a=new Array;var n="";$(e.frheader).find("tr").children("[myui-options*='field:'']").each(function(){$(this).attr("myui-options").split(":");var t=$.parser.parseOptions(this,["field"]);a.push(t.field)});$(e.frheader).find("tr").each(function(t,a){var i=$(this);$(i).append($(e.header).find("tr").eq(t).html());n+=i.prop("outerHTML")});opts.multiHeaderhtml=n;alert(n);opts.frozenCnt=a.length}else{opts.frozenCnt=e.frozenCnt}var i=new Array;var r=new Array;for(var o=0;o<opts.allColumns.length;o++){if(opts.frozenCnt&&o<opts.frozenCnt){i.push(opts.allColumns[o])}else{r.push(opts.allColumns[o])}}if(opts.frozenColumns[0]){opts.frozenColumns[0]=i}else{opts.frozenColumns.push(i)}opts.columns[0]=r;$(t).datagrid2("reLoadPanelStyle");$(t).datagrid2("reloadData",false)}},sortAndFrozenColumn:function(t,e){var a=$(t).datagrid2("data");var n=a.options;var i=n.frozenCnt;var r=new Array(n.allColumns.length);var o=n.allColumnSortList;var l=[];var s=[];var d=0;if(o){var u=0;if(n.allColumns.length>0){if(n.allColumns[0].checkbox){r[0]=n.allColumns[0];u=u+1}}var c=o.split(",");for(var p=0;p<c.length;p++){for(var f=0;f<n.allColumns.length;f++){if(!n.allColumns[f].checkbox&&c[p]==n.allColumns[f].field){r[p+u]=n.allColumns[f]}}}n.allColumns=r}for(var p=0;p<n.allColumns.length;p++){if(i&&p<i){l.push(n.allColumns[p])}else{s.push(n.allColumns[p])}}if(n.frozenColumns[0]){n.frozenColumns[0]=l}else{n.frozenColumns.push(l)}n.columns[0]=s},setColumnHide:function(t,e){var a=$(t).datagrid2("data");var n=a.options;var i=n.showColumnList;var r=[];for(var o=0;o<n.allColumns.length;o++){if((","+i).indexOf(","+n.allColumns[o].field+",")<0&&!n.allColumns[o].checkbox){n.allColumns[o].hidden=true}else{n.allColumns[o].hidden=false}}for(var o=0;o<n.frozenColumns.length;o++){var l=n.frozenColumns[o];for(var s=0;s<l.length;s++){if((","+i).indexOf(","+l[s].field+",")<0&&!l[s].checkbox){l[s].hidden=true}else{l[s].hidden=false}}}for(var o=0;o<n.columns.length;o++){var l=n.columns[o];for(var s=0;s<l.length;s++){if((","+i).indexOf(","+l[s].field+",")<0&&!l[s].checkbox){l[s].hidden=true}else{l[s].hidden=false}}}},getVisableColumn2Json:function(t){var e=$(t).datagrid2("data");var a=e.options;var n=[];for(var i=0;i<a.allColumns.length;i++){var r=a.allColumns[i];if(!r.checkbox&&!r.hidden){n.push(r)}}return n},getVisableColumn:function(t){var e=$(t).datagrid2("data");var a=e.options;var n="";var i="";for(var r=0;r<a.allColumns.length;r++){var o=a.allColumns[r];if(!o.checkbox&&!o.hidden){n+=o.field+",";i+=o.title+","}}return n+"###"+i},filterColumn:function(t,e){var a=$(t).datagrid2("options");a.filterColumnList=e;$(t).datagrid2("updatefilterColumnsArea");$(t).datagrid2("reloadData",true)},updateFilterColumn:function(t){var e=$(t).datagrid2("options");var a=e.filterColumnList;var n=$(t).datagrid2("getVisableColumn").split("###")[0];if(n&&a){e.filterColumnList="";var i=a.split(",");for(var r=0;r<i.length;r++){if(i[r]){var o=i[r].split("###");if(o.length==4&&(","+n).indexOf(","+o[0]+",")>=0){e.filterColumnList+=i[r]+","}}}}$(t).datagrid2("updatefilterColumnsArea")},updatefilterColumnsArea:function(t,e){var a=$(t).datagrid2("data");var n=a.panel;var i=a.options;var r=$(n).children(".datagrid-header");var o=i.filterColumnList;$(r).find("div.filter-columns").remove();if(o&&o.split(",").length>0){var l=$('<div class="filter-columns"></div>');var s=$("<ul></ul>").appendTo($(l));var d=$('<li class="title"><label>清空筛选</label>：</li>').appendTo($(s));var u=o.split(",");for(var c=0;c<u.length;c++){if(u[c]){var p=u[c].split("###");var f=p[0];var m=p[1];if(m=="like"){m="包含"}var h=p[2];var v=p[3];var g=$('<li class="col" name='+f+" id= "+c+">"+v+"&nbsp;"+m+"&nbsp;"+h+' <span class="del">&nbsp;</span></li>').appendTo(s);$(g).bind("click",function(){$(t).datagrid2("deletefilterColumnsArea",$(this))})}}$(d).bind("click",function(){$(t).datagrid2("deletefilterColumnsArea",$(this))});$(r).append(l)}},deletefilterColumnsArea:function(t,e){var a=$(t).datagrid2("data");var n=a.panel;var i=a.options;var r=$(n).children(".datagrid-header");var o=i.filterColumnList;var l=$(e).parent().find("li").length-1;var s="";if(l==1||$(e).attr("class")=="title"){$(e).parent().parent().remove();i.filterColumnList=""}else{$(e).remove();var d=o.split(",");for(var u=0;u<d.length;u++){if(d[u]&&u!=$(e).attr("id")){s+=d[u]+","}}i.filterColumnList=s}request(t,null)},createCondition:function(t,e){var a=$(t).datagrid2("data");var n=a.panel;var i=a.options;var r=n.children(".datagrid-header");var o=$(r).children(".param");var l=$(r).children(".baseop");var s=false;if(i.paramColumnList&&i.paramColumnList!=JSON.stringify(e.param))s=true;i.paramColumnList=JSON.stringify(e.param);if($(o).length>0){$(o).find("input[myui-type='combo']").combo("destroy");$(o).remove();o=null}if($(l).length>0){$(l).remove();l=null}var d;var u;var c;$(e.param).each(function(e){var a=$(this)[0];var n=a.value;if(!n){n=a.defaultVal}if(i.commonParam&&i.commonParam[n]){n=i.commonParam[n]}if($(o).length<=0){if($(r).find(".link").length>0){l=$('<div class="baseop"><ul><li><a href="javascript:void(0);" class="myui-button-query-main">'+myjs_getI18n("i18n_query")+"</a></li></ul></div>").insertAfter($(r).find(".link"));o=$('<div class="param"></div>').insertAfter($(r).find(".link"))}else{l=$('<div class="baseop"><ul><li><a href="javascript:void(0);" class="myui-button-query-main">'+myjs_getI18n("i18n_query")+"</a></li></ul></div>").prependTo($(r));o=$('<div class="param"></div>').prependTo($(r))}var p=$(l).find(".myui-button-query-main");$(p).click(function(){$(t).datagrid2("load")})}if(e%i.paramLineCnt==0){var f=$('<div class="item"></div>').appendTo($(o));d=$("<ul></ul>").appendTo($(f))}c=$('<input type="text" id="'+a.id+'" name="'+a.name+'">');if(n!=""&&n!=null){$(c).val(n);s=true}var m=a.desc;if(a.alias){m=a.alias}var h=$('<li class="desc">'+m+"</li>").appendTo($(d));if(a.partyp=="sql"){$(h).prepend($("<b>* </b>"))}u=$('<li class="ctrl"></li>').appendTo($(d));$(u).append($(c));if(a.type=="date"){$(c).datebox()}else if(a.type=="multinput"){var v=null;if(n!=undefined&&n!="")v=n.split(",");$(c).multinput2({panelHeight:200,panelWidth:280,pasteSeprator:",",defaultValue:v})}else if(a.type=="singleorg"){if(!n)n="";$(c).orgselector({targetid:$(c).attr("id"),winnam:"orgControl",isMultiple:false,defaultValue:n})}else if(a.type=="multiorg"){if(!n)n="";$(c).orgselector({targetid:$(c).attr("id"),winnam:"orgControl",isMultiple:true,defaultValue:n})}else if(a.type=="select"){var g="";if(a.ctrlValue&&a.valtyp){if(a.valtyp=="sql"){g=JSON.parse(a.ctrlValue)[0];var y={sql:g.sql};var b=g.sqlkey.toUpperCase();var w=g.sqlvalue.toUpperCase();var x=JSON.parse('[{"'+b+'":"","'+w+'":"全部"}]');if(a.partyp=="sql"){x=[]}$(c).combo({url:a.sqlurl,param:y,isCustom:true,customData:x,valueField:b,textField:w,editable:true,searchable:true,defaultValue:n})}else{g=JSON.parse(a.ctrlValue);var x=[{key:"",value:"全部"}];if(a.partyp=="sql"){x=[]}$(c).combo({mode:"local",data:g,panelHeight:90,isCustom:true,valueField:"key",textField:"value",customData:x,editable:true,searchable:true,defaultValue:n})}}}else if(a.type=="popradio"||a.type=="popcheckbox"||a.type=="poptree-radio"||a.type=="poptree-checkbox"){var g="";var C=a.type.substring(3);if(a.ctrlValue&&a.valtyp){if(a.valtyp=="sql"){g=JSON.parse(a.ctrlValue)[0];var y={sql:g.sql};var b=g.sqlkey.toUpperCase();var w=g.sqlvalue.toUpperCase();$(c).popselector({type:C,url:a.sqlurl,param:y,valueField:b,textField:w,editable:true,searchable:true,defaultValue:n})}else{g=JSON.parse(a.ctrlValue);$(c).popselector({type:C,mode:"local",data:g,valueField:"key",textField:"value",editable:true,searchable:true,defaultValue:n})}}}});if(typeof e.isReload!="undefined"){s=e.isReload}if(s){$(t).datagrid2("load")}},getColumnAttr:function(t,e){var a=e.split(",");var n="";if(a.length==2){var i=a[0];var r=a[1];if(i&&r){var o=$(t).data("datagrid");var l=o.options;for(var s=0;s<l.allColumns.length;s++){var d=l.allColumns[s];if(l.allColumns[s].field==i)n=d[r]}}}return n},getCase:function(t){var e=$(t).datagrid2("options");var a={page:1};if(e.showColumnList){$.extend(a,{showColumnList:e.showColumnList})}if(e.mergeColumnList){$.extend(a,{mergeColumnList:e.mergeColumnList})}if(e.filterColumnList){$.extend(a,{filterColumnList:e.filterColumnList})}if(e.sort){$.extend(a,{sort:e.sort,order:e.order})}if(e.paramColumnList){var n=JSON.parse(e.paramColumnList);for(var i=0;i<n.length;i++){if(n[i].defaultVal&&n[i].defaultVal!=""){n[i].value=""}}$.extend(a,{paramColumnList:JSON.stringify(n)})}if(e.custColExpr){$.extend(a,{custColExpr:e.custColExpr})}if(e.multiForzenHeaderhtml){$.extend(a,{multiForzenHeaderhtml:e.multiForzenHeaderhtml})}if(e.multiHeaderhtml){$.extend(a,{multiHeaderhtml:e.multiHeaderhtml})}if(e.frozenCnt){$.extend(a,{frozenCnt:e.frozenCnt})}if(e.allColumnSortList){$.extend(a,{allColumnSortList:e.allColumnSortList})}if(e.colDatastyles){$.extend(a,{colDatastyles:e.colDatastyles})}return JSON.stringify(a)},loadCase:function(t,e){if(e){var a=$(t).datagrid2("options");var n=JSON.parse(e);$.extend(a,n);$(t).datagrid2("initCustColumn",a.custColExpr);$(t).datagrid2("setColDatastyles");$(t).datagrid2("sortAndFrozenColumn");if(a.showColumnList)$(t).datagrid2("setColumnHide");$(t).datagrid2("reLoadPanelStyle");if(n.paramColumnList&&n.paramColumnList!=""){var i=JSON.parse(n.paramColumnList);$(t).datagrid2("createCondition",{param:i});var r=$(t).datagrid2("data");var o=r.panel}if($(o).find(".datagrid-header").find(".tableop").length==0){$(o).find(".datagrid-header").find(".baseop").css("height","30px")}if($(t).datagrid2("data").data.datalist.length==0){request(t,null)}}},buildDatagridByJson:function(t,e){if($(t).next().attr("class")=="myui-datagrid2"){$(t).next().remove()}bulidHeadByJson(t,e);var a=$(t).datagrid2("data");opts=$.extend({},$.fn.datagrid2.defaults,$.fn.datagrid2.parseOptions(t));var n=packageGrid(t);opts.allColumns=$.extend(true,[],n.allColumns);opts.columns=$.extend(true,[],n.columns);opts.frozenColumns=$.extend(true,[],n.frozenColumns);
var i={options:opts,panel:n.panel,dc:n.dc,data:{pager:[],datalist:[]}};$(t).datagrid2("cache",i);var r=$(t).find("thead[myui-options*='frozen:true']");var o=$(t).find("thead:not([myui-options*='frozen:true'])");if(r.length>0&&r.find("tr").length>1){opts.multiForzenHeaderhtml=$(r).html()}if(o.length>0&&o.find("tr").length>1){opts.multiHeaderhtml=$(o).html();if(r.find("tr").length!=o.find("tr").length){opts.multiForzenHeaderhtml=null;opts.multiHeaderhtml=null}}$(t).datagrid2("sortAndFrozenColumn");buildGrid(t);showOptBtn(t)},loadDatagrid:function(t,e){if($(t).next().attr("class")=="myui-datagrid2"){$(t).next().remove()}var a=$(t).datagrid2("data");opts=$.extend({},$.fn.datagrid2.defaults,$.fn.datagrid2.parseOptions(t));var n=packageGrid(t);opts.allColumns=$.extend(true,[],n.allColumns);opts.columns=$.extend(true,[],n.columns);opts.frozenColumns=$.extend(true,[],n.frozenColumns);opts.commonParam=e.commonParam;var i={options:opts,panel:n.panel,dc:n.dc,data:{pager:[],datalist:[]}};$(t).datagrid2("cache",i);var r=$(t).find("thead[myui-options*='frozen:true']");var o=$(t).find("thead:not([myui-options*='frozen:true'])");if(r.length>0&&r.find("tr").length>1){opts.multiForzenHeaderhtml=$(r).html()}if(o.length>0&&o.find("tr").length>1){opts.multiHeaderhtml=$(o).html();if(r.find("tr").length!=o.find("tr").length){opts.multiForzenHeaderhtml=null;opts.multiHeaderhtml=null}}var l=$.extend(opts.queryParams,{page:1},e);buildGrid(t);showOptBtn(t);if(!e.queryId&&!l.paramColumnList){request(t,l)}},getCheckedRowData:function(t){var e=$(t).datagrid2("getData");var a=$(t).datagrid2("data");var n=a.panel;var i=a.options;var r=a.dc;var o=$(r.list).find("div.datagrid_list_tableData").find('input[name="checkboxitem"]:checked');var l=new Array;for(var s=0;s<o.length;s++){var d=o[s];l.push(e.datalist[$(d).parent().parent().parent().attr("idx")])}return l},getRowDataByIdx:function(t,e){var a=$(t).datagrid2("getData");return a.datalist[e]},getChecked:function(t){var e=$(t).datagrid2("data");var a=e.panel;var n=e.dc;var i=$(n.list).find("div.datagrid_list_tableData").find('input[name="checkboxitem"]:checked');var r=new Array;for(var o=0;o<i.length;o++){var l=i[o];r.push($(l).attr("value"))}return r},setListHeight:function(t,e){var a=$(t).datagrid2("data");var n=a.dc;$(t).height(e);$(n.list).height(e);$(n.list).find("div.datagrid_list_tableLayout").height(e);$(n.list).find("div.datagrid_list_tableData").height(e)},clickCheck:function(t,e){var a=$(t).datagrid2("data");var n=a.dc;var i=$(n.list).find('tr.data-row[idx="'+e+'"]');if($(i).eq(1).find('input[name="checkboxitem"]').attr("checked")==undefined||$(i).eq(1).find('input[name="checkboxitem"]').attr("checked")==false){$(i).find('input[name="checkboxitem"]').attr("checked",false)}else{$(i).find('input[name="checkboxitem"]').attr("checked",true)}},checkAll:function(t){var e=$(t).datagrid2("data");var a=e.dc;$(a.list).find('tr.data-row input[name="checkboxitem"]').attr("checked",true)},unCheckAll:function(t){var e=$(t).datagrid2("data");var a=e.dc;$(a.list).find('tr.data-row input[name="checkboxitem"]').attr("checked",false)},getSelections:function(t){},clearChecked:function(t){},clearChecked:function(t){},unselectAll:function(t){}};$.fn.datagrid2.defaults={id:null,title:null,url:null,iconCls:null,width:null,height:null,left:null,paramLineCnt:2,defaultSelPager:"15,30,50,100",top:null,isAutoBuild:true,frozenCnt:0,defaultQuery:true,showExport:true,exportFileName:"导出列表",showColumn:false,showColumnList:null,allColumnSortList:null,colDatastyles:null,defaultLoadColumnSize:20,currentLoadColumnSize:0,hasMoreColumn:false,mergeColumnList:null,filterColumnList:null,paramColumnList:null,beforeExport:null,selectMaxExportCnt:0,multiForzenHeaderhtml:null,multiHeaderhtml:null,pagination:true,queryParams:{},multiSort:false,remoteSort:true,isAutoHeight:true,pagestyle:"default",method:"post",onBeforeLoad:function(t){},onLoadSuccess:function(){},defaultHeight:300,defaultLength:1200,remoteSort:true,onSortColumn:function(t,e){},loader:function(t,e,a){var n=$(this).datagrid2("options");if(!n.url)return false;$.ajax({type:n.method,url:n.url,data:t,dataType:"json",success:function(t){e(t)},error:function(t,e,a){$.messager.alert("错误","加载数据错误","error",$(this).datagrid2("loaded"))}})}};$.fn.datagrid2.parseOptions=function(t){var e=$(t);return $.extend({},$.parser.parseOptions(t,["url","param"]))}})(jQuery);(function(t){t.fn.window=function(a,n){if(typeof a=="string"){return t.fn.window.methods[a](this,n)}a=a||{};return this.each(function(){var n=t(this).attr("id");var i;var r=t.data(this,"window");if(r){i=t.extend(r.options,a);e(this)}else{i=t.extend({},t.fn.window.defaults,t.fn.window.parseOptions(this),a);r=t.data(this,"window",{options:i});e(this)}})};function e(e){var i=t.data(e,"window").options;var r=t(e).html();t(e).empty();var o=t('<div class="myui-window1 '+n()+'"></div>').appendTo(t(e));if(i.left=="")i.left=(t(document.body).width()-i.panelWidth)/2;var l=t(window.parent.document).scrollTop();l=0;o.css({width:i.panelWidth,height:i.panelHeight,top:l+i.top,left:i.left});var s=t('<div class="top"></div>').appendTo(o);s.append('<div class="left"></div>');var d=t('<div class="main"></div>').appendTo(s);d.css("width",i.panelWidth-6);d.append('<ul><li class="title">'+i.headline+'</li><li class="close"></li></ul>');s.append('<div class="right"></div>');var u=t('<div class="body"></div>').appendTo(o);u.append(i.content);var c=u.children("iframe");c.css({height:i.panelHeight-32});d.children().children(".close").bind("click",function(a){if(i.onBeforeClose){i.onBeforeClose.call()}t(e).window("close")});d.mousedown(function(e){var a=true;var n=t(document).width();var i=e.pageX-o.offset().left;var r=e.pageY-o.offset().top;t(document).mousemove(function(t){if(a){var e=o;var n=0;if(t.pageX-i<=0){n=0}else{n=t.pageX-i}e.css({left:n,top:t.pageY-r>=0?t.pageY-r:0})}}).mouseup(function(){a=false})});if(!i.open){t(e).window("close")}else{t(e).window("open")}a(t(e))}function a(e){var a=null;if(isNaN(e)){a=t(e).find("iframe").height()}else{return false}t(e).find("iframe").on("load",function(){var n=a-t(e).find("iframe").contents().find(".myui-form .operate").height()-10;t(e).find("iframe").contents().find(".myui-form .form").css("height",n+"px");t(e).find("iframe").contents().find("body").append('<div id="'+t(e).attr("id")+'" class="myui-window-obj"></div>')})}function n(){var e=t.browser;var a="";if(e.msie){a="IE"}if(a!="IE"){return"myui-window1-shadow"}else if(a=="IE"&&parseInt(e.version)>8){return"myui-window1-shadow"}else{return""}}t.fn.window.methods={options:function(e){if(typeof t.data(e[0],"window")!="undefined")return t.data(e[0],"window").options;else return""},open:function(e){t(e).css("display","block");add_mod()},close:function(e,a){if(t(e[0]).window("options").onBeforeClose){t(e[0]).window("options").onBeforeClose.call()}t(e).css("display","none");clean_mod()},getContentHeight:function(t){},getData:function(t){},getValue:function(t){},getValues:function(t){},setValue:function(t,e){},setValues:function(t,e){},loadData:function(t,e){},reload:function(t,e){},clear:function(t){},reset:function(t){}};t.fn.window.defaults={panelWidth:400,panelHeight:300,top:40,left:"",headline:"窗口",content:"",open:false,open_location:"current",uuid:"",param:null,onBeforeClose:function(){}};t.fn.window.parseOptions=function(e){var a=t(e);return t.extend({},t.parser.parseOptions(e,["url"]))}})(jQuery);(function(t){function e(e){var n=t('<div class="myui-message1"></div>').appendTo("body");var i=t('<div class="myui-window1 '+a()+'" ></div>').appendTo(t(n));if(e.left=="")e.left=(t(document.body).width()-e.panelWidth)/2;var r=t(window.parent.document).scrollTop();r=0;i.css({width:e.panelWidth,height:e.panelHeight,top:r+e.top,left:e.left});var o=t('<div class="top"></div>').appendTo(i);o.append('<div class="left"></div>');var l=t('<div class="main"></div>').appendTo(o);l.css("width",e.panelWidth-6);l.append('<ul><li class="title">'+e.headline+'</li><li class="close"></li></ul>');o.append('<div class="right"></div>');var s=t('<div class="body"></div>').appendTo(i);s.css({height:e.panelHeight-32});l.children().children(".close").bind("click",function(e){t(n).window("close")});s.append(e.content);var d=t('<div class="message-btn"></div>').appendTo(s);var u=t('<a href="javascript:void(0)" class="myui-button-red">'+e.ok+"</a>").appendTo(d);s.children(".myui-messager-body").css({height:e.panelHeight-87});if(e.type=="alert"){d.css("margin-left",105);u.focus();u.bind("click",function(a){t(n).window("close");e.fn()});l.children().children(".close").bind("click",function(t){e.fn()})}else if(e.type=="confirm"){d.css("margin-left",65);var c=t('<a href="javascript:void(0)" class="myui-button-gray myui-messager-button">'+e.cancel+"</a>").appendTo(d);u.focus();u.bind("click",function(a){t(n).window("close");e.fn(true,t(n))});c.bind("click",function(a){t(n).window("close");e.fn2(true,t(n))});l.children().children(".close").bind("click",function(a){e.fn2(true,t(n))})}else if(e.type=="confirm2"){d.css("margin-left",65);var c=t('<a href="javascript:void(0)" class="myui-button-gray myui-messager-button">'+e.cancel+"</a>").appendTo(d);u.focus();u.bind("click",function(a){t(n).window("close");e.fn(true,t(n))});c.bind("click",function(e){t(n).window("close");return false})}if(!e.open){t(n).window("close")}else{t(n).window("open")}}function a(){var e=t.browser;var a="";if(e.msie){a="IE"}if(a!="IE"){return"myui-window1-shadow"}else if(a=="IE"&&parseInt(e.version)>8){return"myui-window1-shadow"}else{return""}}t.messager={show:function(t){},alert:function(a,n,i,r){var o=typeof a=="object"?a:{headline:a,msg:n,icon:i,fn:r};var l=o.icon?"myui-messager-icon myui-messager-"+o.icon:"";o=t.extend({},t.messager.defaults,{content:'<div class="'+l+'"></div>'+'<div class="myui-messager-body">'+o.msg+"</div>",type:"alert"},o);e(o)},confirm:function(a,n,i,r){var o=typeof a=="object"?a:{headline:a,msg:n,fn:i,fn2:r};o=t.extend({},t.messager.defaults,{content:'<div class="myui-messager-icon myui-messager-info"></div>'+'<div class="myui-messager-body">'+o.msg+"</div>",type:"confirm"},o);e(o)},confirm2:function(a,n,i){var r=typeof a=="object"?a:{headline:a,msg:n,fn:i};r=t.extend({},t.messager.defaults,{content:'<div class="myui-messager-icon myui-messager-info"></div>'+'<div class="myui-messager-body">'+r.msg+"</div>",type:"confirm2"},r);e(r)}};t.messager.defaults=t.extend({},t.fn.window.defaults,{ok:myjs_getI18n("i18n_ok"),cancel:myjs_getI18n("i18n_cancel"),panelWidth:280,panelHeight:160,headline:"窗口",content:"",open:true,fn:function(){},fn2:function(){}})})(jQuery);(function(t){$.msgpusher={layer:{width:250,height:150},title:"提醒信息",time:4e3,anims:{type:"slide",speed:600},timer:null,init:function(t,e){var a=$("#myui-msgpusher",top.document);if($(a).is("div")){return}var n="<div id='myui-msgpusher' class='myui-msgpusher' style='width:"+this.layer.width+"px;height:"+this.layer.height+"px;'>"+"<div class='myui-msgpusher-top'>"+"<span id='myui-msgpusher-close' class='myui-msgpusher-close'>X</span>"+"<div class='myui-msgpusher-title'>"+t+"</div>"+"<div style='clear:both;'></div>"+"</div>"+"<div class='myui-msgpusher-main'>"+"<div id='myui-msgpusher-content' class='myui-msgpusher-content' style='width:"+(this.layer.width-17)+"px;height:"+(this.layer.height-50)+"px;'>"+e+"</div>"+"</div>"+"</div>";$(top.document.body).prepend(n);$("#myui-msgpusher-close",top.document).bind("click",function(t){$.msgpusher.close()});$(top.window).scroll(function(){if(top.$("#myui-msgpusher")){$("#myui-msgpusher",top.document).css("bottom",0-$(top.window).scrollTop())}});$("#myui-msgpusher",top.document).bind("mouseover",function(t){if($.msgpusher.timer!=null){clearTimeout($.msgpusher.timer);$.msgpusher.timer=null}}).bind("mouseout",function(t){$.msgpusher.timer=setTimeout(function(){$.msgpusher.close()},$.msgpusher.time)})},show:function(t,e,a){var n=$("#myui-msgpusher",top.document);if($(n).is("div")){return}if(t==0||!t)t=this.title;if(a>=0)this.time=a;this.init(t,e);$("#myui-msgpusher",top.document).css("bottom",0-$(top.window).scrollTop());switch(this.anims.type){case"slide":$("#myui-msgpusher",top.document).slideDown(this.anims.speed);break;case"fade":$("#myui-msgpusher",top.document).fadeIn(this.anims.speed);break;case"show":$("#myui-msgpusher",top.document).show(this.anims.speed);break;default:$("#myui-msgpusher",top.document).slideDown(this.anims.speed);break}this.rmmessage(this.time)},lays:function(t,e){if($("#myui-msgpusher",top.document).is("div")){return}if(t!=0&&t)this.layer.width=t;if(e!=0&&e)this.layer.height=e},anim:function(t,e){if($("#myui-msgpusher",top.document).is("div")){return}if(t!=0&&t)this.anims.type=t;if(e!=0&&e){switch(e){case"slow":break;case"fast":this.anims.speed=200;break;case"normal":this.anims.speed=400;break;default:this.anims.speed=e}}},rmmessage:function(t){if(t>0){this.timer=setTimeout(function(){$.msgpusher.close()},t)}else{this.close()}},close:function(){switch(this.anims.type){case"slide":$("#myui-msgpusher",top.document).slideUp(this.anims.speed);break;case"fade":$("#myui-msgpusher",top.document).fadeOut(this.anims.speed);break;case"show":$("#myui-msgpusher",top.document).hide(this.anims.speed);break;default:$("#myui-msgpusher",top.document).slideUp(this.anims.speed);break}setTimeout(function(){$("#myui-msgpusher",top.document).remove()},this.anims.speed);this.original()},original:function(){this.layer={width:250,height:150};this.title="信息提示";this.time=4e3;this.anims={type:"slide",speed:600}}}})(jQuery);$(function(){setSelected("tab");setSelected("seltile");setMutiSelected("muti_seltile");loadmybilayout();$("body").keyup(function(){if(event.keyCode==13){if($(".main_button").length>0&&$(".main_button").attr("enter")!="false"){$(".main_button").trigger("click")}else if($(".myui-button-query-main").length>0&&$(".myui-button-query-main").attr("enter")!="false"){$(".myui-button-query-main").trigger("click")}else if($(".myui-button-query-main-big").length>0&&$(".myui-button-query-main-big").attr("enter")!="false"){$(".myui-button-query-main-big").trigger("click")}}});setConditionHide();if($.parser.auto){$.parser.parse()}$.ajaxSetup({cache:false});var t=$.browser;var e="";if(t.msie){e="IE"}if(e=="IE"&&parseInt(t.version)<=7){$("i").remove()}});function myui_datagrid_renderOrder(t){$("input[name='sort']").remove();$("input[name='order']").remove();var e=$('<input type="hidden" name="sort"> ').insertAfter($(".myui-datagrid"));var a=$('<input type="hidden" name="order"> ').insertAfter($(".myui-datagrid"));$(".myui-datagrid  th[sortable$='true']").each(function(n){var i=$(this).attr("field");$(this).mouseenter(function(t){$(this).css("background","#F9FFC9").css("cursor","pointer")}).mouseleave(function(t){$(this).css("background","#F8F6ED").css("cursor","normal")});$(this).bind("click",function(n){var r=$(this).html();if(r.indexOf("↓")>=0){$(this).html(r.replace("↓","↑"));if(e.val().indexOf(",")==-1){a.val("ASC")}else{var o=myui_tools_getStrCnt(e.val(),i,",")-1;a.val(myui_tools_array_getStr4Sign(myui_tools_array_replace4Index(a.val().split(","),"ASC",o),","))}}else if(r.indexOf("↑")>=0){$(this).html(r.replace("↑","").replace(" ",""));if(e.val().indexOf(",")==-1){e.val("");a.val("")}else{var o=myui_tools_getStrCnt(e.val(),i,",")-1;e.val(e.val().replace(","+i,"").replace(i+",",""));a.val(myui_tools_array_getStr4Sign(myui_tools_array_remove4Index(a.val().split(","),o),","))}}else{$(this).append(" ↓");if(e.val()==""){e.val(i);a.val("DESC")}else{e.val(e.val()+","+i);a.val(a.val()+",DESC")}}if(t&&typeof t=="function"){t(1)}})})}function tmp_component_before_load(t){if(t=="datagrid"){add_onload()}}function tmp_component_after_load(t){if(t=="datagrid"){clean_onload();$(".myui-datagrid table tr input:checkbox").parent().css("text-align","center").css("padding-left","0px").css("width","25px");if($(".myui-datagrid table tr th:last").parent().index()%2==0){$(".myui-datagrid table tr").addClass("myui-datagrid-tr-odd");$(".myui-datagrid table tr:even").addClass("myui-datagrid-tr-even")}else{$(".myui-datagrid table tr").addClass("myui-datagrid-tr-odd");$(".myui-datagrid table tr:odd").addClass("myui-datagrid-tr-even")}$(".myui-datagrid table tr").addClass("tr_hover")}}function tmp_component_error_load(t,e){if(t=="datagrid"){clean_onload()}if(e!=""){$.messager.alert("错误",e,"error")}}function add_mod(t){if(typeof t!="undefined"){$(t).append('<div class="myui-template-masklayer"></div>');$(t).children(".myui-template-masklayer").show()}else{$(document.body).append(' <div class="myui-template-masklayer"></div>');$(document.body).children(".myui-template-masklayer").show()}}function clean_mod(t){if(typeof t!="undefined"){$(t).children(".myui-template-masklayer").remove()}else{$(document.body).children(".myui-template-masklayer").remove()}}function add_onload(){$(document.body).append('<div class="myui-template-onloadlayer"><div class="myui-template-onloadlayer-mod"></div><div class="myui-template-onloadlayer-img"></div></div>');$(document.body).children(".myui-template-onloadlayer").show()}function clean_onload(){$(document.body).children(".myui-template-onloadlayer").remove()}function getIdFieldsOfChecked(){var t="";var e=$("input[name='checkboxitem']:checked");if(e.length>=1){for(var a=0;a<e.length;a++){t+=$(e[a]).val()+","}}return t}function checkAll(t){var e=document.getElementsByName(t);var a=e.length;for(var n=0;n<a;n++){if(e[n].disabled==false){e[n].checked=window.event.srcElement.checked}}}(function($){$.fn.orgselector=function(t,e){if(typeof t=="string"){return $.fn.orgselector.methods[t](this,e)}t=t||{};return this.each(function(){var e=$(this).attr("id");var a;var n=$.data(this,"orgselector");if(n){a=$.extend(n.options,t);create(this)}else{a=$.extend({},$.fn.orgselector.defaults,$.fn.orgselector.parseOptions(this),t);n=$.data(this,"orgselector",{options:a});create(this)}})};function create(t){var e=$.data(t,"orgselector").options;var a=$(t).width();var n=e.width||a;var i=e.height||240;if(e.editable&&!e.fuzzyMatch){$(t).blur(function(){setDefaultValue(t)}).keyup(function(a){if(e.onBeforeClick.call()){if(a.keyCode=="13"){setDefaultValue(t)}else if(a.keyCode=="38"||a.keyCode=="40"){$(t).parent().find(".myui-orgselector-fuzzymatch select").focus()}else if(a.keyCode=="188"&&!e.isMultiple){$(t).val($(t).val().replaceAll(",",""))}else{fuzzyMatchOrgByInput(t)}}})}if(!e.editable){$(t).attr("readonly","readonly")}if(e.showIcon){$(t).wrap('<span class="myui-orgselector-outer" style="width:'+a+'px;"></span>');$(t).after('<a class="myui-orgselector-search-ico"></a>');$(t).css("width",a-25).css("border","none");$(t).parent().find(".myui-orgselector-search-ico").click(function(){var a=e.onBeforeClick.call();if(a){setDefaultValue(t);showOrgSelectorWin(t)}})}if(e.editable&&e.fuzzyMatch){$(t).after("<div class='myui-orgselector-fuzzymatch' style='width:"+n+"px;height:"+i+"px;'><select size='10' style='width:"+n+"px;height:"+i+"px;'><option></option></select></div>");$(t).parent().find(".myui-orgselector-fuzzymatch select").click(function(){hideFuzzyMatchDiv(this,t)}).keyup(function(e){if(e.keyCode=="13"){hideFuzzyMatchDiv(this,t)}});$(t).keyup(function(a){autoAdjustPosition(t);if(e.onBeforeClick.call()){if(a.keyCode=="13"){setDefaultValue(t)}else if(a.keyCode=="38"||a.keyCode=="40"){$(t).parent().find(".myui-orgselector-fuzzymatch select").focus()}else if(a.keyCode=="188"&&!e.isMultiple){$(t).val($(t).val().replaceAll(",",""))}else{fuzzyMatchOrgByInput(t)}}}).blur(function(){setDefaultValue(t)})}$.get("pim_org-info!clearDatalist.action");$.ajaxSettings.async=false;$.post("pim_org-selector!init.action",{},function(a){if($.trim(e.defaultValue)!=null&&$.trim(e.defaultValue)!=""){$(t).val(e.defaultValue);setDefaultValue(t)}$.ajaxSettings.async=true})}function autoAdjustPosition(t){var e=$(t).position();var a=$.data(t,"orgselector").options;var n=$(t).outerWidth();var i=$(t).outerHeight();var r=$(t).parent().find(".myui-orgselector-fuzzymatch");if($(r).prev().position().top+$(t).height()+2+$(a.scrollTarget).scrollTop()>$(a.scrollTarget).height()+$(a.scrollTarget).scrollTop()+40){$(r).css({top:$(r).prev().position().top,left:$(r).prev().position().left})}else{$(r).css({top:$(r).prev().position().top+$(t).height()+2,left:$(r).prev().position().left})}}function setDefaultValue(t){$.ajaxSettings.async=false;var e=$.data(t,"orgselector").options;$.post("pim_org-selector!saveTmpData.action",{tokenId:e.tokenId,selectedorg:$(t).val()},function(t){$.ajaxSettings.async=true})}function setValue(t,e){$(t).val(e);setDefaultValue(t)}function fuzzyMatchOrgByInput(t){$(t).parent().find(".myui-orgselector-fuzzymatch").show();$("body").bind("click",onBodyDown);var e={orgidt:$(t).val()};$.post("pim_org-info!fuzzyMatchOrgByInput.action",e,function(e){var a="";if(e.datalist.length>0){$(e.datalist).each(function(t,e){if(t==0){a+="<option selected='selected' value=\""+e["ORGIDT"]+'">['+e["ORGIDT"]+"]"+e["SHORTNAM"]+"</option>"}else{a+='<option value="'+e["ORGIDT"]+'">['+e["ORGIDT"]+"]"+e["SHORTNAM"]+"</option>"}})}$(t).parent().find(".myui-orgselector-fuzzymatch select").html(a)},"json").error(function(t,e,a){$.messager.alert('<s:text name="common_msg_info"/>',t.responseText,"info")})}function onBodyDown(t){$(".myui-orgselector-fuzzymatch").hide()}function hideFuzzyMatchDiv(t,e){var a=$.data(e,"orgselector").options;if(a.isMultiple){insertText(e,$.trim($(t).val()))}else{$(e).val($(t).val());$(e).focus()}$(e).parent().find(".myui-orgselector-fuzzymatch").hide();$(e).parent().find(".myui-orgselector-fuzzymatch select").html("<option></option>")}var rie;function getCursor(t){if(document.all){var e=$(t);e.focus();rie=document.selection.createRange()}}function insertText(t,e){var a=document.getElementById($(t).attr("id"));var n=$.trim($(t).val());if(document.selection){a.focus();var i=document.selection.createRange();var r=0,o=0;if(i==null){r=o=0}else{var l=a.createTextRange(),s=l.duplicate();l.moveToBookmark(i.getBookmark());s.setEndPoint("EndToStart",l);r=o=s.text.length}if(n.indexOf(",")==-1){$(t).val(e)}else{var d=n.substring(0,r-1);var u=n.substring(o,n.length);var c=d.substring(0,d.lastIndexOf(","));var p=u.substring(u.indexOf(","),u.length);if($.trim(c)==null||$.trim(c)==""){$(t).val(e+p)}else{$(t).val(c+","+e+p)}}}else if(a.selectionStart){a.focus();if(n.indexOf(",")==-1){$(t).val(e)}else{var r=a.selectionStart||s.text.length,o=a.selectionEnd||s.text.length;var d=n.substring(0,r-1);var u=n.substring(o,n.length);var c=d.substring(0,d.lastIndexOf(","));var p=u.substring(u.indexOf(","),u.length);if($.trim(c)==null||$.trim(c)==""){$(t).val(e+p)}else{$(t).val(c+","+e+p)}}}else if(typeof a.selectionStart==="number"&&typeof a.selectionEnd==="number"){var r=a.selectionStart,o=a.selectionEnd,f=r;var d=n.substring(0,r-1);var u=n.substring(o,n.length);var c=d.substring(0,d.lastIndexOf(","));var p=u.substring(u.indexOf(","),u.length);if($.trim(c)==null||$.trim(c)==""){$(t).val(e+p)}else{$(t).val(c+","+e+p)}a.selectionStart=a.selectionEnd=f}else{var r=a.selectionStart,o=a.selectionEnd;var d=n.substring(0,r-1);var u=n.substring(o,n.length);var c=d.substring(0,d.lastIndexOf(","));var p=u.substring(u.indexOf(","),u.length);if($.trim(c)==null||$.trim(c)==""){$(t).val(e+p)}else{$(t).val(c+","+e+p)}}}function showOrgSelectorWin(target){var opts=$.data(target,"orgselector").options;var url="pim_org-selector!toManage.action?"+$.param(opts);if(opts.framename==null||opts.framename==""){$("#"+opts.winnam).window({open:true,headline:'<s:text name="org_selector_orgsel_headline"/>',content:'<iframe id="myframe" src='+url+' scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:900,panelHeight:420,onBeforeClose:function(){$.post("pim_org-selector!getSelectedOrg.action",{tokenId:opts.tokenId},function(data){$(target).val(data);if(opts.onCallback){eval(opts.onCallback+".call()")}})}})}else{parent.$("#"+opts.winnam).window({open:true,headline:'<s:text name="org_selector_orgsel_headline"/>',content:'<iframe id="myframe" src='+url+' scrolling="no" frameborder="0" style="width:100%;height:100%;overflow:hidden;" />',panelWidth:900,panelHeight:420,onBeforeClose:function(){$.post("pim_org-selector!getSelectedOrg.action",{tokenId:opts.tokenId},function(data){$(target).val(data);if(opts.onCallback){eval("parent."+opts.onCallback+".call()")}})}})}}$.fn.orgselector.defaults={targetid:"",defaultValue:"",framename:"",winnam:"orgSelectorWin",tabname:"TP_PIM_ORG",rootnode:"",width:0,height:0,tokenId:"",withAuth:true,isMultiple:true,editable:true,fuzzyMatch:true,showIcon:true,onCallback:"",onBeforeClick:function(){return true}};$.fn.orgselector.methods={options:function(t){return $.data(t[0],"orgselector").options},setValues:function(t,e){return t.each(function(){setValue(this,e)})}};$.fn.orgselector.parseOptions=function(t){var e=$(t);return $.extend({},$.parser.parseOptions(t,["targetid","defaultValue","framename","winnam","tabname","rootnode","width","height","tokenId","withAuth","isMultiple","editable","fuzzyMatch","showIcon","onCallback","onBeforeClick"]))}})(jQuery);function monitorExportStatus(t){tmp_component_before_load("datagrid");loadingInterval=window.setInterval(function(){$.get(t,{},function(t){if(t=="exported"){tmp_component_after_load("datagrid");window.clearInterval(loadingInterval)}else if(t=="exception"){$.messager.alert('<s:text name="common_msg_info"/>','<s:text name="common_msg_exportfail"/>',"info");tmp_component_after_load("datagrid");window.clearInterval(loadingInterval)}})},1500)}function isHasSpecialChar(t){var e=/^[^ 　]+$/;if(t!=null&&t!=""&&!e.test(t)){return false}return true}function getByClass(t){var e=[];var a=document.getElementsByTagName("*");for(var n=0;n<a.length;n++){if(a[n].className==t){e.push(a[n])}}return e}function myui_tools_getStrCnt(t,e,a){var n=new Array;var n=t.split(a);for(var i=0;i<n.length;i++){if(n[i]==e){return i+1}}}function myui_tools_array_remove4Index(t,e){var a=new Array;var n=0;for(var i=0;i<t.length;i++){if(i!=e){a[n]=t[i];n++}}return a}function myui_tools_array_replace4Index(t,e,a){for(var n=0;n<t.length;n++){if(n==a)t[n]=e}return t}function myui_tools_array_getStr4Sign(t,e){var a="";for(var n=0;n<t.length;n++){if(n==0)a=t[n];else a+=","+t[n]}return a}function myjs_getI18n(t){if(typeof top.getSysI18n!="undefined"){i18n_lang=top.getSysI18n()}var e="";$.each(jQuery.parseJSON(i18n_conf),function(a,n){if(t==n.name){e=n[i18n_lang];return false}});return e}String.prototype.replaceAll=function(t,e,a){if(!RegExp.prototype.isPrototypeOf(t)){return this.replace(new RegExp(t,a?"gi":"g"),e)}else{return this.replace(t,e)}};function json2UrlParam(t){var e="";for(var a in t){e+="&"+a+"="+t[a]}return e.replaceAll("#","%23")}function getUrlParam(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)");var a=window.location.search.substr(1).match(e);if(a!=null)return unescape(a[2]);return null}function formatNum2Thousand(t){if(t.length<=3){return t}if(!/^(\+|-)?(\d+)(\.\d+)?$/.test(t)){return t}var e=RegExp.$1,a=RegExp.$2,n=RegExp.$3;var i=new RegExp;i.compile("(\\d)(\\d{3})(,|$)");while(i.test(a)){a=a.replace(i,"$1,$2$3")}return e+""+a+""+n}function setConditionHide(t){if(t&&$(".myui-template-condition-hide").find("div")){if(t==$(".myui-template-condition-hide").find("div").attr("class")){return false}else{$(".myui-template-condition-hide").find("div").click()}}else{var e=$(".myui-template-condition-hide");if(e.length>0){var a=e.attr("showcnt");if(a==null){a=1}e.empty();e.append('<div class="up"></div>');e.children("div").click(function(){var t=$(this);$(".myui-template-condition").each(function(e){if(t.hasClass("down")){$(this).show()}else{if(e>a-1)$(this).hide()}});$(this).toggleClass("down")})}}}function loadmybilayout(t){var e=$(".myui-layout");if(t){e=t}var a='<div class="row-gap">&nbsp;</div>';var n='<div class="line-gap" >&nbsp;</div>';var i=$(e).children().length;$(e).children().each(function(t){if(i-t-1>0){$(this).after(n)}if($(this).hasClass("content")||$(this).hasClass("tabs")){graywin($(this))}if($(this).hasClass("rowgroup")||$(this).hasClass("linegroup")){var e=$(this);var r=$(this).children().length;$(this).children().each(function(t){if(r-t-1>0){if(e.hasClass("rowgroup")){$(this).after(a)}else{$(this).after(n)}}if(e.hasClass("rowgroup")){$(this).addClass("row-content")}if($(this).hasClass("content")||$(this).hasClass("tabs")){graywin($(this))}if($(this).hasClass("rowgroup")||$(this).hasClass("linegroup")){var i=$(this).children().length;var o=$(this);$(this).children().each(function(t){if(i-t-1>0){if(o.hasClass("rowgroup")){$(this).after(a)}else{$(this).after(n)}}if(o.hasClass("rowgroup")){$(this).addClass("row-content")}if($(this).hasClass("content")||$(this).hasClass("tabs")){graywin($(this))}})}})}})}function graywin(divstr){var len=divstr.css("width").replace("px","");var hei=divstr.css("height").replace("px","");var title=divstr.attr("title");var headline=divstr.attr("headline");if(title==null){if(headline==null){title=""}else{title=headline}}divstr.removeAttr("title");var tab_dedault_select=null;var tab_position="left";if(divstr.attr("position")!=null&&divstr.attr("position")=="right"){var tab_position="right"}var op="";var op_objs=divstr.children(".operate").children("ul").children("li");if(op_objs.length>0){op_objs.each(function(t){if(t>0)op+="&nbsp;";op+=$(this).html();if(op_objs.length-1>t)op+="&nbsp;|"});divstr.children(".operate").remove()}var bd=divstr.html();var main_len=len-8;var body_len=len-2;var body_hei=hei-33;var win_hei=hei-0+1;divstr.addClass("myui-template-graywin");divstr.css("height",win_hei+"px");var top_main_htm='<div class="top-main" style="width: '+main_len+'px"><ul><li class="title">'+title+'</li><li class="operate">'+op+"</li></ul></div>";var tabs_content_all="";var tabs_content_cur="";if(divstr.hasClass("tabs")){var top_main_htm='<div class="top-main" style="width: '+main_len+'px"><ul>';if(tab_position=="right"){top_main_htm+='<li class="title" style="float:left">'+title+"</li>"}else{top_main_htm+='<li class="title" style="float:right">'+title+"</li>"}var top_main_htm_li="";divstr.children(".tabcontent").each(function(t){var e="";if($(this).attr("onclick")!=null){e=$(this).attr("onclick");if(e.indexOf('"')>=0){e="onclick='"+e+"'"}else{e='onclick="'+e+'"'}}var a=$(this).attr("title");var n=$(this).attr("headline");if(a==null){if(n==null){a=""}else{a=n}}if(tab_position=="right"){top_main_htm_li='<li class="tab" ind='+t+" "+e+' style="float:right">'+a+"</li>"+top_main_htm_li}else{top_main_htm_li+='<li class="tab" ind='+t+" "+e+' style="float:left">'+a+"</li>"}$(this).attr("ind",t);tabs_content_all+=$(this).prop("outerHTML");if($(this).attr("selected")!=null&&($(this).attr("selected")=="true"||$(this).attr("selected")=="selected")){tab_dedault_select=t}});top_main_htm=top_main_htm+top_main_htm_li+'<li class="operate">'+op+"</li></ul></div>"}divstr.empty();divstr.append('<div class="top-left"></div>');divstr.append(top_main_htm);divstr.append('<div class="top-right"></div>');divstr.append('<div class="top-body"  style="height: '+body_hei+"px;width: "+body_len+'px"></div>');if(divstr.hasClass("tabs")){divstr.append(tabs_content_all);var tabcontents=divstr.children(".tabcontent");divstr.children(".tabcontent").hide();var tab_all=divstr.children(".top-main").children("ul").children(".tab");tab_all.each(function(i){var curtab=tabcontents.eq($(this).attr("ind"));if(tab_dedault_select!=null&&curtab.attr("selected")!=null&&(curtab.attr("selected")=="true"||curtab.attr("selected")=="selected")){$(this).attr("class","tab-selected");divstr.children(".top-body").html(curtab.html())}var cust_onclick=$(this).attr("onclick");if(cust_onclick!=null){$(this).attr("onclick","")}$(this).bind("click",function(e){if($(this).hasClass("tab-selected")){return false}if(cust_onclick!=null){var rst=eval(cust_onclick);if(!rst&&rst!=null)return false}tab_all.attr("class","tab");$(this).attr("class","tab-selected");divstr.children(".top-body").html(curtab.html())})})}else{divstr.children(".top-body").html(bd)}}function getContentByTab(t){var e;var a=$(t).attr("ind");if($(t).attr("class")=="tabcontent"){
var n=$(t).parent().children("[class='tabcontent']")}else if($(t).attr("class")=="tab"){var n=$(t).parent().parent().parent().children("[class='tabcontent']")}else{return false}n.each(function(t){if(a==$(this).attr("ind")){e=$(this);return false}});return e}function setTabSelectedByTab(t){var e=$(t).parent().children(".top-main").children("ul").children("[class^='tab']");e.each(function(e){if($(this).attr("ind")==$(t).attr("ind")){$(this).attr("class","tab-selected");$(t).parent().children(".top-body").html($(t).html())}else{$(this).attr("class","tab")}})}(function(t){t.parser={auto:true,onComplete:function(t){},plugins:["combo","comboSD","inputbox","datebox","window","fileupload","orgselector","datagrid2","cycle","tooltip","popselector","multinput"],parse:function(e){for(var a=0;a<t.parser.plugins.length;a++){var n=t.parser.plugins[a];var i=t(".myui-"+n,e);if(i.length){if(i[n]){i[n]()}}}t.parser.onComplete.call(t.parser,e)},parseOptions:function(e,a){var n=t(e);var i={};var r=t.trim(n.attr("myui-options"));if(r){if(r.substring(0,1)!="{"){r="{"+r+"}"}i=new Function("return "+r)()}if(a){var o={};for(var l=0;l<a.length;l++){var s=a[l];if(typeof s=="string"){if(s=="width"||s=="height"||s=="left"||s=="top"){o[s]=parseInt(e.style[s])||undefined}else{o[s]=n.attr(s)}}else{for(var d in s){var u=s[d];if(u=="boolean"){o[d]=n.attr(d)?n.attr(d)=="true":undefined}else if(u=="number"){o[d]=n.attr(d)=="0"?0:parseFloat(n.attr(d))||undefined}}}}t.extend(i,o)}return i}}})(jQuery);function setSelected(t){var e=getByClass(t);for(var a=0;a<e.length;a++){var n=e[a].getElementsByTagName("li");for(var i=0;i<n.length;i++){n[i].onclick=function(){var t=this.parentNode.getElementsByTagName("li");for(var e=0;e<t.length;e++){t[e].className=t[e].className.replace("_selected","")}if(this.className.indexOf("_selected")<=0){this.className=this.className+"_selected"}}}}}function setMutiSelected(t){var e=getByClass(t);for(var a=0;a<e.length;a++){var n=e[a].getElementsByTagName("li");for(var i=0;i<n.length;i++){n[i].onclick=function(){var t=this.parentNode.getElementsByTagName("li");if(this.className.indexOf("_selected")>=0){this.className=this.className.substring(0,this.className.indexOf("_selected"))}else{this.className=this.className+"_selected"}}}}}function setWindowFormLayout(t){var e=null;if(isNaN(t)){e=$(t).find("iframe").height()}else{e=t}var a=e-$(".myui-form .operate").height()-10;$(".myui-form .form").css("height",a+"px")}(function(t){t.fn.jqLoading=function(e){var a={backgroudColor:"#ECECEC",backgroundImage:"../image/loading.gif",text:"玩命加载中....",width:150,height:60,type:0};var n=t.extend({},a,e);if(n.type==0){o()}else{s(this)}if(e==="destroy"){l()}function i(){var e,a;if(t.browser.msie&&t.browser.version<7){e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);a=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(e<a){return t(window).height()}else{return e}}else if(t.browser.msie&&t.browser.version==8){return t(document).height()-4}else{return t(document).height()}}function r(){var e,a;if(t.browser.msie){e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);a=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(e<a){return t(window).width()}else{return e}}else{return t(document).width()}}function o(){var e=t("<div id='layer'></div>");e.css({zIndex:9998,position:"absolute",height:i()+"px",width:r()+"px",background:"black",top:0,left:0,filter:"alpha(opacity=30)",opacity:.3});var a=t("<div id='content'></div>");a.css({textAlign:"left",position:"absolute",zIndex:9999,height:n.height+"px",width:n.width+"px",top:"50%",left:"50%",verticalAlign:"middle",background:n.backgroudColor,borderRadius:"8px",fontSize:"13px"});a.append("<img style='vertical-align:middle;margin:"+n.height/4+"px; 0 0 5px;margin-right:5px;' src='"+n.backgroundImage+"' /><span style='text-align:center; vertical-align:middle;'>"+n.text+"</span>");t("body").append(e).append(a);var o=a.css("top").replace("px","");var l=a.css("left").replace("px","");a.css("top",parseFloat(o)-n.height/2).css("left",parseFloat(l)-n.width/2);return this}function l(){t("#layer,#content,#partialLayer").remove();return this}function s(e){var a=t(e).css("height");var n=t(e).css("width");var i=t(e).offset().top;var r=t(e).offset().left;var o=t("<div id='partialLayer'></div>");o.css({style:"z-index:9998",position:"absolute",height:a,width:n,background:"black",top:i,left:r,filter:"alpha(opacity=60)",opacity:.6,borderRadius:"3px",dispaly:"block"});t("body").append(o);return this}}})(jQuery);